<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Hola hackers!, what’s up?, I hope you all doin good .As a CSE student we are to take vocationl training and submit a project(not major one) in that, we were told to make a project and present it that">
<meta property="og:type" content="article">
<meta property="og:title" content="Boot2Root CTF WriteUp : Pwn2Own">
<meta property="og:url" content="https://sf4ult.github.io/2023/02/12/post2/pwn2own/index.html">
<meta property="og:site_name" content="sf4ult">
<meta property="og:description" content="Hola hackers!, what’s up?, I hope you all doin good .As a CSE student we are to take vocationl training and submit a project(not major one) in that, we were told to make a project and present it that">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/logo.jpg">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/nmap-scan1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/nmap-scan.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/ftp-login.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/ftp-data.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/get-image.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/file-check1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/eog-image1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/qr-decode.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/part1-decode.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/file-check2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/exifinfo.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/binwalk-res.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/steghide-info.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/extracted.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/tree-cmd.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/flag-file.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/part2-flag.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/part2-cred.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/nmap-scan2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/homepage.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/gobuster-scan.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/web-hint.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/robots-txt.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/fake-flag.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/sakshi-okay.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/secret-dir.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/rev-readme.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/wget-something.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/extract-something.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/playme-run.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/playme-passguess.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/playme-strings.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/rev-pass.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/functions.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/ghidra-mainn.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/ghidra-main2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/xor-op.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/xor-op2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/py-xor.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/gobuster-scan2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/wordpress-look.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/gobuster-scan3.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/wp-login.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/dashboard.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/yeah-bwoi-grin.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/404-page.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/nc-conn.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/nc-shell.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/part3-flag.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/part2-flag2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/cyberchef.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/cyberchef2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/pwner-shell.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/pwner-shell2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/pwner-readme.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/etc-pass.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/last-login.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/history.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/alice-shell.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/alice-shell2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/alice-flag.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/alice-readme.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/crontab.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/cron-base64.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/cron-perm.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/bash-shell2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/tty-upgrade.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/perfect.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/bob-shell.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/scp-linenum.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/linenum-res.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/suid-bin.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/root-me-res.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/wget-url.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/wget-decomp.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/Evil-code.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/Evil-code2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/Evil-code3.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint3.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint4.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint5.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint6.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint7.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint8.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint9.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint10.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint11.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint12.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint13.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint14.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint15.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint15.2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/osint/osint16.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-res.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-res2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-win.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-mainfunc.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/memory-layout.jpg">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/stack-layout.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/stack-frame.jpg">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/bof.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb3.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb4.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb5.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb5.1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb6.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/final-gdb7.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/win-adr.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/win-nm.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/exp1.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/exp2.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/iamroot.gif">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/root-flag.png">
<meta property="og:image" content="https://sf4ult.github.io/imgs/post2/wink2.gif">
<meta property="article:published_time" content="2023-02-12T08:19:38.000Z">
<meta property="article:modified_time" content="2023-05-08T20:35:32.459Z">
<meta property="article:author" content="Durgesh">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Boot2Root">
<meta property="article:tag" content="Project">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sf4ult.github.io/imgs/post2/logo.jpg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Boot2Root CTF WriteUp : Pwn2Own</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 vazir">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archive">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/04/08/post3/ca_2023/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/09/12/post1/thm-recovery/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://sf4ult.github.io/2023/02/12/post2/pwn2own/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&text=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&is_video=false&description=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Boot2Root CTF WriteUp : Pwn2Own&body=Check out this article: https://sf4ult.github.io/2023/02/12/post2/pwn2own/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&name=Boot2Root CTF WriteUp : Pwn2Own&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&t=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Reconnaissance-Scanning"><span class="toc-number">1.</span> <span class="toc-text">Reconnaissance, Scanning</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gaining-Access"><span class="toc-number">2.</span> <span class="toc-text">Gaining Access</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">2.1.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Manually"><span class="toc-number">2.1.1.</span> <span class="toc-text">Manually</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaining-root-privilege-01"><span class="toc-number">2.1.2.</span> <span class="toc-text">Gaining root privilege - 01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bob-password"><span class="toc-number">2.1.3.</span> <span class="toc-text">Bob password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaining-root-privilege-02"><span class="toc-number">2.1.4.</span> <span class="toc-text">Gaining root privilege - 02</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Program-Execution"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">Program Execution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how-stack-work"><span class="toc-number">2.1.4.2.</span> <span class="toc-text">how stack work?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Activation-records-x2F-Stack-frame"><span class="toc-number">2.1.4.3.</span> <span class="toc-text">Activation records&#x2F;Stack frame</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Registers"><span class="toc-number">2.1.4.4.</span> <span class="toc-text">Registers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Calling-convention"><span class="toc-number">2.1.4.5.</span> <span class="toc-text">Calling convention</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Now-we-know-the-all-base-knowlege-to-understand-buffer-overflow-attack-lets-see-how-buffer-overflow-can-be-performed-and-how-can-we-execute-any-arbitary-code-into-memory-or-transfer-code-flow-to-any-evil-function"><span class="toc-number">2.1.4.5.1.</span> <span class="toc-text">Now we know the all base knowlege to understand buffer overflow attack lets see how buffer overflow can be performed and how can we execute any arbitary code into memory or transfer code flow to any evil function</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">3.</span> <span class="toc-text">Conclusion</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Boot2Root CTF WriteUp : Pwn2Own
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Durgesh</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-02-12T08:19:38.000Z" class="dt-published" itemprop="datePublished">2023-02-12</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Boot2Root/" rel="tag">Boot2Root</a>, <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Project/" rel="tag">Project</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Hola hackers!, what’s up?, I hope you all doin good .<br>As a CSE student we are to take vocationl training and submit a project(not major one) in that, we were told to make a project and present it that could be related to any suitable domain i started thinking about creating any network monitoring or malware analysis tool as i didn’t ever try to create big project i was excited to research from scratch and then trying to build own one </p>
<p>but i didn’t have enough time for that so i  thought about simple CTF based vulnerable machine where the aim was to introduce student to cybersecurity in a fun way by capturing the flag.<br>i tried to keep it begineer friendly(although it depends on player for new who don’t know anything about gonna bit tough) as this is college project majority of the student is not familiar to CTF </p>
<p>moreover i am going to share this blog link as a writeup with my project so for that reason i’ll keep this writeup as simple as possible so that one can understand what’s going on even if he&#x2F;she don’t know anything.<br>it might lengthy for someone who already know basic but bear with me i hope you’ll learn something new here :) </p>
<p>So in this blog i’ll walk you through this home made :P CTF machine however, i will write another blog where i’ll be writing how i created this machine and how you can create your own by yourself from the scratch.</p>
<p>As almost all CTF machine follows phases of hacking gradually i am going to design machine following those 5 phases i.e. Reconnaissance, Scanning, Gaining Access, Maintaing Acess ,Clearing Track.</p>
<p>Machine - <a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects/tree/main/Pwn2Own">link</a> (i’ll upload this on THM later and update this link) </p>
<p>so let’s start ……</p>
<p><img src="/imgs/post2/logo.jpg" alt="logo here"></p>
<p>i am assuming you already done with machine setup and you have your machine up and running and assuming myself as i am solving this machine without knowing anything. </p>
<blockquote>
<p>It might there are grammer mistakes ‘cause i didn’t re-read my writeup as it was too lengthy so please bear … </p>
</blockquote>
<h1 id="Reconnaissance-Scanning"><a href="#Reconnaissance-Scanning" class="headerlink" title="Reconnaissance, Scanning"></a>Reconnaissance, Scanning</h1><p>First thing we require is IP of machine so that we can perform our reconnaissance and Scanning, as this machine is on ‘Bridged Adapter ‘ network type, IP will be at same adress space you can find our your with <strong>ifconfig</strong>, <strong>hostname -I</strong>  or using <strong>ip addr show ‘interface’</strong>  here my ip address is <strong>192.168.61.128</strong> .</p>
<p>I am using nmap(Nmap or Netwok mapper is a network scanning tool ,an open source Linux command-line tool—used for <strong>network scanning, host discovery, and security auditing</strong>. ) here for scanning machine </p>
<p><strong>command - <code>nmap -sV 192.168.61.0-255</code></strong> </p>
<p>-sV switch for scan open ports to determine service&#x2F;version info and 255 added in last octed to scan all host, as target machine is part of same adress space it is going to scan by nmap </p>
<p><img src="/imgs/post2/nmap-scan1.png" alt="nmap-scan1"></p>
<p>as you can see image above second ip addr is target machine’s ip with nmap scan report<br>look at the all header above now we know all PORT their STATE , SERVICE and VERSION<br>we can serach for vulnerability using port service version if used version is vulnerable we can exploit the service and gain access to the machine .</p>
<p>power of nmap -  nmap is smart enough to find out some low hanging fruit vulnerability<br>we can use -sC switch to see , is there any script available to exploit  those vulnerability<br>or verbose any service weakness.</p>
<p><img src="/imgs/post2/nmap-scan.png" alt="nnmap-scan"></p>
<p>there we go , see outlined result above we are allowed to login as anonymous in ftp server which is to say we don’t need any credentials(Anonymous authentication in FTP is avulnerability that allows users to log in with a user name of FTP or anonymously)<br>so lets login to ftp as anonymous user </p>
<p><img src="/imgs/post2/ftp-login.png" alt="ftp-login"></p>
<p>see what we got here ? , some jpg images and and README.txt file<br>README.txt is for you :)<br>lets focus on those images sequentially </p>
<p><img src="/imgs/post2/ftp-data.png" alt="ftp-data"></p>
<p>firstly download the images to your host machine using ‘get’ command</p>
<p><img src="/imgs/post2/get-image.png" alt="get-image"></p>
<p>01_insideme.jpeg -&gt; checking image file to see is it really what its looking like </p>
<p><img src="/imgs/post2/file-check1.png" alt="file-check1"></p>
<p>hmm, yeah now i am sure it is jpeg file , lets open it </p>
<p><img src="/imgs/post2/eog-image1.png" alt="eog-image1"></p>
<p>got QR code here, do we have to make payment via this code ? :D<br>then what it could be, one way to know is scan this code we can use simple QR-reader application on our phone or if you are too lazzy to do that use linux utility ‘zbarimg’ .</p>
<p><img src="/imgs/post2/qr-decode.png" alt="qr-decode"></p>
<p>we got part1 credential , but whats inside that curly braces looks like some cipher text<br>yeah obviously who don’t knows base64,it is base64 encoded string lets decode with linux utility base64 </p>
<p><img src="/imgs/post2/part1-decode.png" alt="decode-part1"></p>
<p>got <strong>user : pwner</strong> that could be username of any server maybe local user in target machine? if so it will require while ssh-ing .<br>hmm, now let’s look 02_hidden.jpg file same as before check the file info with file command</p>
<p><img src="/imgs/post2/file-check2.png" alt="file-check2"></p>
<p>can you see comment section, got some string over there it seems like tried to hide information in this image file lets print EXIF data(<em>EXIF data</em> contains information on image and audio files. EXIF stands for Exchangeable Image File Format. we can consider it as a meta data(data of data)) using tool exiftool(ExifTool is a free and open-source software program for reading, writing, and manipulating image, audio, video, and PDF metadata) </p>
<p><img src="/imgs/post2/exifinfo.png" alt="exifinfo.png"></p>
<p>has different headers here but more interesting one is ‘Comment’ header that we found earlier in file command it says ‘do you know looping making things handy’ , is it some kind of hint to solve challenge, okay lets bear in mind for now ,<br>hmm, so we have given image here what the most possbile way to hide something in another file or image here as far as i know stegno , isn’t it? </p>
<p>from the size(300kb) of image file it is possible to hide some data here remember last challenge however, that was QR code but it is possible ,so keeping that in mind is used some stegno tool here </p>
<p>1 - binwalk(Binwalk is <strong>a tool for searching a given binary image for embedded files and executable code</strong>)</p>
<p><img src="/imgs/post2/binwalk-res.png" alt="binwalk-res"></p>
<p>nothing special here lets try another one,</p>
<p>2 - Steghide(<em>Steghide</em> is a steganography program that is able to hide data in various kinds of image- and audio-files.)</p>
<p><img src="/imgs/post2/steghide-info.png" alt="steghid-info"></p>
<p>we asked for password just hit enter as we don’t know and it worked we didn’t need t, a zip file got extracted here<br>lets extract this zip file </p>
<p><img src="/imgs/post2/extracted.png" alt="extracted"></p>
<p>oh my … lots of directories precisely 1000 folders here which one contain flag here<br>maybe file40? , file100? or file249? okay now we are to fine second part of our credentials<br>checking each directory manually one by one gonna take tremendious time isn’t it?</p>
<p>what we can do is use a utility call ‘tree’ for navigating to each dirs and printing whats inside there whereby we could know which one contain our credential</p>
<p><img src="/imgs/post2/tree-cmd.png" alt="tree-cmd"></p>
<p>as you can see by using <code>tree *</code> command we got to know <strong>file840</strong> contain list of file<br>so lets change directory to file840 and list the file </p>
<p><img src="/imgs/post2/flag-file.png" alt="flag-file"></p>
<p>uhhhh , again but now i can’t use ‘tree’ command ‘cause that work for directory not data or text file , remember that hint before we got from exif-tool - <strong>do you know looping making things handy</strong> , hmm talking about loop here …. oh okay gotcha! we have to automate our work using loop statement here , you can use any suitable lang here</p>
<p>i am using shell here as it will work interactive here , but i don’t think you are require to write any script here, more easy way to grab the contain is using <strong>grep</strong> command we just have to search for paritcular string in these files , now what should be that string </p>
<p>hmm .. first challenge had part1{} syntax so it should be part2{} here lets try.. </p>
<p><strong>command -  <code>grep part2 *</code></strong></p>
<p><img src="/imgs/post2/part2-flag.png" alt="part2-flag"></p>
<p>hmm, gotcha ..<br>lets decode it , tried base64 that throw invalid input with gebberish value if you know familiar with base encoding technique it seems like base32 lets try that one.</p>
<p><img src="/imgs/post2/part2-cred.png" alt="part2-cred"></p>
<p>okay so come up with string here , it seems to incomplete<br>we are to capture 3 parts of credentials we already done two<br>so far captured credentials are  -<br>**user : pwner , there y0u go - “__m__o__n” ** </p>
<p>so <strong>pwner</strong> is username and <strong>“__m__o__n”</strong> seems to be password of that user but problem is its  incomplete , okay lets move ahead .</p>
<p>if you payed attention while scanning the IP, we also had <strong>port 80 http service</strong> running with <strong>apache</strong> server over there </p>
<p><img src="/imgs/post2/nmap-scan2.png" alt="nmap-scan2"></p>
<p>so lets browse the target ip in browser and see what we got there </p>
<p><img src="/imgs/post2/homepage.gif" alt="hompage"></p>
<p>okay so as expected website running here , lets walk around see what got here </p>
<p>i started go-buster(Gobuster is a tool used to brute-force URIs including directories and files as well as DNS subdomains) without thinking anything and searching for any usefull info while go buster is running</p>
<blockquote>
<p>Note : using dirlist&#x2F;directory-list-2.3-medium.txt wordlist that comes by default dirbuster i guess , download from <a target="_blank" rel="noopener" href="https://github.com/drtychai/wordlists/blob/master/dirbuster/directory-list-2.3-medium.txt">here</a> </p>
</blockquote>
<p><img src="/imgs/post2/gobuster-scan.png" alt="gobuster-scan"></p>
<p>during that i got base64 encoded string in site’s source code </p>
<p><img src="/imgs/post2/web-hint.png" alt="web-hint"></p>
<p>decoding this string got msg says <strong>Hint : do you know how to stop crawler from access sensitive content in your website ?</strong><br>aftere some google fu , got to know that we can use <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Robots.txt">robots.txt</a> file for that purpose one more thing usually stored on home directory of website whis is to say <strong>host&#x2F;robots.txt</strong> </p>
<p>lets browse robots.txt file and what we got there </p>
<p><img src="/imgs/post2/robots-txt.png" alt="robots-txt"></p>
<p>Interesting ! , &#x2F;flag.txt is Disallowed from crawling the user agent where &#x2F;secret directory is allowed … both look tempting we are to capture the flag.txt eventually is it that flag we have been told to capture lets see ..</p>
<p><img src="/imgs/post2/fake-flag.png" alt="fake-flag"></p>
<p><img src="/imgs/post2/sakshi-okay.gif" alt="sakshi-okay"></p>
<p>so it was fake flag, hmm never mind lets move ahead we still have &#x2F;secret dir to check</p>
<p><img src="/imgs/post2/secret-dir.png" alt="secret-dir"></p>
<p>ahhaaa! , some juicy stuff lets read README.txt file first</p>
<p><img src="/imgs/post2/rev-readme.png" alt="rev-readme"></p>
<p>by reading this README.txt file we got to know that we should have basic understanding of RE and tools used , okayyy i was born ready :P  now lets look at tar file </p>
<p><img src="/imgs/post2/wget-something.png" alt="wget-something"></p>
<p><img src="/imgs/post2/extract-something.png" alt="extract-something"></p>
<p>after extracting the file we got binary call <strong>playme</strong> lets run the binary </p>
<p><img src="/imgs/post2/playme-run.png" alt="playme-run"></p>
<p>here we are to guess the password lets try to enter some random string </p>
<p><img src="/imgs/post2/playme-passguess.png" alt="playme-passgues"></p>
<p>hmm… okay so approach to solve RE challenge is to firstly look for low hanging fruit like strings on binary there is possibility to get some crucial info<br>so lets check for stirngs usign <strong>strings</strong> utility in linux</p>
<p><img src="/imgs/post2/playme-strings.png" alt="playme-stinrgs"></p>
<p>printing out strings in binary we come up with some interesting strings as you can see  above image over there , printed strings when we saw while guessing the pasword as well as some extra interesing aftere <strong>Guess the password :</strong> string there is string look like password , tried to use that string as a password </p>
<p><img src="/imgs/post2/rev-pass.png" alt="rev-pass"></p>
<p>okay so it was password for that binary , now we been saying to find the flag<br>i thought i solved this challenge but as name implies it is based on Reverse engineering not gonna be that easy .. now what next? remeber we been told have prior knowledge of debugger(A debugger or debugging tool is a computer program used to test and debug other programs.) and decompiler(A decompiler is a computer program that translates an executable file to a high-level source file which can be recompiled successfully) </p>
<p>i fired ghidra(Ghidra is a free and open source reverse engineering tool developed by the National Security Agency of the United States) ‘cause i &lt;3 ghidra , after pulling binary to ghidra we have to look for function as a compiled code contain lot of functions i.e. system function and user defined function , after looking at <strong>Symbol Tree</strong> section on ghidra we found some function listed these are being used in binary </p>
<p><img src="/imgs/post2/functions.png" alt="function"></p>
<p>As we know programm start with <strong>main</strong> porgram i started reading decompiled main function </p>
<p><img src="/imgs/post2/ghidra-mainn.png" alt="ghidra-main"></p>
<p>it looks bit messy here in starting as ghidra generate psuedo code but after paying attnetion and changing varibles name to undrestandable name it became more convenient.</p>
<p><img src="/imgs/post2/ghidra-main2.png" alt="ghidra-main2"></p>
<p>lets understand now how exactly program is running ..<br>initially some local variable are initiated i.e. - user_input, input_length and result then user is asked to Guess the password(line 14) as saw while running the binary and then user input are stored on user_input vairable and then in next line hardcoded string is compared with user’s input and return  value is stored in <strong>result</strong> var, consequently that resultant var is compared whether it is equal to <strong>0</strong> or not , if it is then then congratulate strings are printed and program enters into for loop(19) or else , else message in else part is printed .</p>
<p>okay, so everything is expected here but whats in for loop? lets see<br>hmm… a loop is going on starting from 0(i&#x3D;0) and looping until given condition is met i.e. var ‘i’ value less than user’s input_length and meanwhile user’s each input char(user_input[i]) is xored(look at the ‘^’ sign over there depicted in screenshot above) with 0x42(66) number(line 21) and getting stored in user_input var itself </p>
<p>so in case if you do not know how XOR operation work simply putting  XOR compares two input bits and generates one output bit. The logic is simple. If the bits are the same, the result is 0. If the bits are different, the result is 1.</p>
<p><img src="/imgs/post2/xor-op.png" alt="xor-op"></p>
<p>but we don’t have two bit as 0’s and 1’s we are dealing with char and number here so how this operation take place lemme elaborate just keep your eye in this image below </p>
<p><img src="/imgs/post2/xor-op2.png" alt="xor-op2"></p>
<p>lets suppose our Original Message is <strong>a,b,c,d</strong> shown image above and as these chars are part of ASCII  character set if we encode in decimal we will get <strong>97,98,99,100</strong> sequentially that is being used as Byte and Encryption Key is <strong>69</strong> XOR operation of each char’s decimal form to Encryption key i.e. 69 we get another decimal number that is then decoded as char .</p>
<p>okay so long story short we are to get those decoded value that is being stored on user_input var in each loop and getting over-write with next one .</p>
<p>how we can achieve that? , as we already know user_input i.e. original message and encryption key i.e. 66 we are to just run XOR operation or else had to debug the binary and see each character in single loop at run time</p>
<p>wrote simple python script </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def xor(s, v):</span><br><span class="line">return &quot;&quot;.join(chr(ord(c) ^ v) for c in s)</span><br><span class="line"></span><br><span class="line">xored_string = xor(&#x27;durge5h3#*9sd&#x27;, 0x42)</span><br><span class="line">print(xored_string)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/imgs/post2/py-xor.png" alt="py-xor"></p>
<p>Bravo, finally we got it .</p>
<blockquote>
<p>XOR result &#x3D; <code>&amp;70%&#39;w*qah&#123;1&amp;</code>  </p>
</blockquote>
<p>whats the use of this gebberish string , is this password? if so where to use?<br>don’t know just bear in mind for now maybe gonna use later</p>
<p>woops, we forgot the GO-buster completely lets see what he got</p>
<p><img src="/imgs/post2/gobuster-scan2.png" alt="gobuster-scan2.png"></p>
<p>hmm … got another dircotry <strong>&#x2F;wordpress</strong> it seems wordpress CMS running here let browse to <strong>192.168.61.239&#x2F;wordpress</strong> location </p>
<p><img src="/imgs/post2/wordpress-look.gif" alt="wordpress-look"></p>
<p>Okay wordpress site running here hmm website inside website interesing<br>i’ll repeat same step as earlier , going to run <strong>go buster</strong> against this site and simultaneously walking around this site it might possible we come up with some hint or any secret hidden info like we found previously </p>
<p>as this is wordpress CMS site we can use wordpress scanner(<strong>used to scan WordPress websites for known vulnerabilities both in WordPress and commonly used WordPress plugins and themes</strong>.) but ‘cause i was facing some issue in my WP scanner therefore i didn’t able to .</p>
<p>switch -u  for target URL -w for wordlist and -x to include desirable extensions</p>
<p><img src="/imgs/post2/gobuster-scan3.png" alt="gobuster-scan3"></p>
<p>so go-buster busted with these directory most tempting one is <strong>&#x2F;wp-login.php</strong> although tried remaining nothing got there , lets jump to <strong>&#x2F;wp-login.php</strong> </p>
<p><img src="/imgs/post2/wp-login.png" alt="wp-login"></p>
<p>apeared this login page , we require username and password to login into wordpress dashboard<br>hmm … what now ?<br>at this moment i went all the way back and continued to retrace my step noted down all the assets i discoverd from the start and those are :</p>
<blockquote>
<p><strong>part1 - user : pwner<br>par2 - there y0u go - “__m__o__n”</strong><br>binary password - <code>durge5h3#*9sd</code><br>xored string - <code>&amp;70%&#39;w*qah&#123;1&amp;</code> </p>
</blockquote>
<p>i tried pwner as username and password as <code>durge5h3#*9sd</code>  , username : pwner, password:  <code>&amp;70%&#39;w*qah&#123;1&amp;</code> but no use , i still doubt on <code>&amp;70%&#39;w*qah&#123;1&amp;</code>  , sweated blood for this, no use?</p>
<p>And silly me i did brute force on username field and got admin as a username, i should have tried some default and most usefull credentialls which are mostly used bydefault i.e admin:admin, admin:password, admint:root123, admin:pass123 and what not. </p>
<p>now <strong>admin</strong> as a username then  <code>&amp;70%&#39;w*qah&#123;1&amp;</code>  as password  and guess what ?</p>
<p><img src="/imgs/post2/dashboard.png" alt="dashboard"></p>
<p><img src="/imgs/post2/yeah-bwoi-grin.gif" alt="yeah-bwoi-grin.gif"></p>
<h1 id="Gaining-Access"><a href="#Gaining-Access" class="headerlink" title="Gaining Access"></a>Gaining Access</h1><p>We logged in as admin, now questions arises what next? what if someone did able to login into wordpress admin dashboard ?</p>
<p><strong>They will have access to a wide range of features and functions that allow them to manage the content and settings of the WordPress site. This includes the ability to create and publish new posts and pages, manage users and permissions, install and activate plugins and themes, and make changes to the site’s appearance and settings.</strong> </p>
<p>okay so he has privilege to do lot , as we are hunting for <strong>root</strong> flag we require to access to system somehow, so with my goal in mind started thinking about getting a reverse shell as we are aware this machine running apache server where site is hosted on localhost okay so since server is apache backend development language is most probably gonna PHP isn’t it ?</p>
<p>Getting php reverse shell but how?<br>As we are admin now we can acess, read and write any file we have to look for any php file where we can place our php shell and run that file since we will be listening for connection successfully able to get local user privileged shell on system </p>
<p>Now which file to place our php shell into ? yeah <strong>404.php</strong>  if you know how <strong>404.php</strong> file work if we try to acess any page that is moved or if we <strong>misspelled URL</strong> then we pop with 404.php page </p>
<p>so when we write our reverse shell here and <strong>typo</strong> URL deliberately our shell get executed and this way we manage to make connection with machine .</p>
<p>location of 404.php page : Tools -&gt; Theme File Editor -&gt; look at the right side <strong>Theme Files</strong> section and search for 404.php page in our case located at <strong>inc&#x2F;patterns&#x2F;404.php</strong> </p>
<p>okay so lets replace ALL code with php <a href="">reverse shell</a> and replace the ip address with your machine then Update File  </p>
<p><img src="/imgs/post2/404-page.png" alt="404-page"></p>
<p>Start netcat listener on give port i.e. 6666 here and then misspelled URL and hit enter that makes php script execute </p>
<p><img src="/imgs/post2/nc-conn.png" alt="nc-conn"></p>
<p>Voila ! we got our shell with user <strong>www-data</strong> :(</p>
<p><img src="/imgs/post2/nc-shell.png" alt="nc-shell"></p>
<p>okay now lets see what we can do here ,if we list the current directory there flag.txt file</p>
<p><img src="/imgs/post2/part3-flag.png" alt="part3-flag"></p>
<p><img src="/imgs/post2/part2-flag2.png" alt="part2-flag2"></p>
<p>okay so this is part3 credential we had to find lets decode the cipher text via <a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">Cyberchef</a><br>after decoing other previous encoded string now we can recognize from the pattern of this text belong from base encoding format so i tried base64 and base32 out of which base32 make more sense </p>
<p><img src="/imgs/post2/cyberchef.png" alt="cyberchef"></p>
<p>if we see output it all alphabetic chars here but doesn’t make sense not able to read single word it seems like chars are interchanged with any other chars to make thing robust, hmm… so if you know about this technique it’s called substituion (In cryptography, a substitution cipher is a method of encrypting in which units of plaintext are replaced with the ciphertext) there are some substitution technique tried one by one some of them and eventually end up with ROT13</p>
<p><img src="/imgs/post2/cyberchef2.png" alt="cyberchef2"></p>
<p>Output :</p>
<blockquote>
<p>wow 0.0 you really did it, way to go !!!<br>  have it, and go ahead<br>  “”” letm3log1n “”” </p>
</blockquote>
<p>okay now we have all 3 part credentials .</p>
<ul>
<li>part1 -&gt; username: pwner</li>
<li>par2 -&gt; “__m__o__n” </li>
<li>part3 -&gt; letm3log1n</li>
</ul>
<p>now lets solve the puzzle , skipping part2 as it was part3’s incomplete form , left with part1 and par2 no need to think too much these are username and password maybe for making connection with machine , we can do it using ssh </p>
<p><img src="/imgs/post2/pwner-shell.png" alt="pwner-shell"></p>
<p>and hell yeah we got the local use shell here , not prolonging anymore started exploring this user account ,there two files i.e. README.txt and user1.txt in home directory </p>
<p><img src="/imgs/post2/pwner-shell2.png" alt="pwner-shell2"></p>
<p>user1.txt contain the flag(not root flag :( ) okay so it isn’t over yet .</p>
<p><img src="/imgs/post2/pwner-readme.png" alt="pwner-readme"></p>
<p>in README.txt file talking ‘bout <strong>history</strong> computer science maybe hint to proceed ahead okay lets keep in mind </p>
<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>We have to escalate our privilege to root user to get the root flag </p>
<p>Two way to proceed<br>-&gt; With tool :- where we run the tool in the user system and try to get the vulnerable point to bypasses the proper authorization channel, and successfully grants themselves access to data we are not supposed to have<br>-&gt; Manually: try to achieve same goal manually</p>
<h3 id="Manually"><a href="#Manually" class="headerlink" title="Manually"></a>Manually</h3><blockquote>
<p>Throughout entire privilege escalation i didn’t have to use automation tool but for the sake of intro to automation tool or how to automate privesc i did use during escalting to root user.</p>
</blockquote>
<p>i followed <a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation#users">this</a> methodology </p>
<p><img src="/imgs/post2/etc-pass.png" alt="etc-pass"></p>
<p>came to know there is two more local user i.e. alice, bob and if we check last login history user  was also loged in as bob </p>
<p><img src="/imgs/post2/last-login.png" alt="last-login"></p>
<p>rememberd from history README.txt file was talking about history computer science lets print history utility and see if we get any juicy info </p>
<p><img src="/imgs/post2/history.png" alt="history"></p>
<p>okhayyy, i was right look at line number 8 and 9 user logged in into mysql databse and granting privilege to user <strong>alice</strong> , okay now we know the password of user alice we can login using command<br><strong>su alice</strong> </p>
<p><img src="/imgs/post2/alice-shell.png" alt="alice-shell"></p>
<p>easypeasy, now we are user alice !</p>
<p><img src="/imgs/post2/alice-shell2.png" alt="alice-shell2.png"></p>
<p>listing the current directory we get user flag and README.txt file  </p>
<p><img src="/imgs/post2/alice-flag.png" alt="alice-flag"></p>
<p><img src="/imgs/post2/alice-readme.png" alt="alice-readme"></p>
<p>hmm…  talking about shedule so if you know<br>In Unix-like operating systems The cron command-line utility is a job scheduler. Users who set up and maintain software environments use cron to schedule jobs, also known as cron jobs, to run periodically at fixed times, dates, or intervals.<br>and for that purpose we use <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/crontab-in-linux-with-examples/">crontab</a> </p>
<p>is table that contain list of all task we want to run at specific time , <strong>location</strong> -&gt; &#x2F;etc&#x2F;crontab </p>
<p><img src="/imgs/post2/crontab.png" alt="crontab"></p>
<p>look at the last two lines there is shell script al location <strong>&#x2F;opt&#x2F;scripts&#x2F;pwn2own.sh</strong> running after every 30 sec by user <strong>bob</strong> and in last line user <strong>root</strong> overwriting that script with some <strong>base64</strong> decoded string and then changing file owner to alice and setting wirte permission </p>
<p>after decoding that base64 string </p>
<p><img src="/imgs/post2/cron-base64.png" alt="cron-base64"></p>
<p>okay nothing usefull, butttt we know that <strong>crontab</strong> run as root user </p>
<p><img src="/imgs/post2/cron-perm.png" alt="cron-perm"></p>
<p>so it means that <strong>pwn2own.sh</strong> script going to run as bob and what we can do is we can place our bash <a target="_blank" rel="noopener" href="https://www.revshells.com/">reverse shell</a> into that script before 30 sec or after 1 minute as script run within each 30 sec and overwrite after every 1 minute </p>
<p><img src="/imgs/post2/bash-shell2.png" alt="bash-shell"></p>
<p>We’ve a shell but when we <strong>ctrl+c</strong> we can miss it, we should it upgrade like in the below:</p>
<p><strong>-The first thing</strong>: to do is use <strong>python3 -c ‘import pty;pty.spawn(“&#x2F;bin&#x2F;bash”)’</strong>, which uses Python to spawn a better-featured bash shell. At this point, our shell will look a bit prettier, but we still won’t be able to use tab autocomplete or the <strong>arrow keys</strong>, and <strong>Ctrl + C</strong> will still kill the shell.  </p>
<p>-<strong>Step two is</strong>: <strong>export TERM&#x3D;xterm</strong> — this will give us access to term commands such as clear.  </p>
<p>-<strong>Finally</strong> <strong>(and most importantly)</strong> we will background the shell using <strong>Ctrl + Z</strong>. Back in our own terminal we use <strong>stty raw -echo; fg</strong>. This does two things: first, it turns off our own terminal echo (which gives us access to <strong>tab autocompletes</strong>, <strong>the arrow keys</strong>, and <strong>Ctrl + C</strong> to kill processes). It then foregrounds the shell, thus completing the process.  </p>
<p>-<strong>Note</strong> <strong>that if the shell dies</strong>, any input in your own terminal will not be visible (as a result of having disabled terminal echo). <strong>To fix this</strong>, type <strong>reset</strong> and press enter.</p>
<p><img src="/imgs/post2/tty-upgrade.png" alt="tty-upgrade"></p>
<p><img src="/imgs/post2/perfect.gif" alt="perfect"></p>
<p>Started digging again , in current directory we have user3 flag and README.txt file </p>
<p><img src="/imgs/post2/bob-shell.png" alt="bob-shell"></p>
<p>README.txt talking about <strong>Secure Coding</strong> okay lets keep in mind and enemurate the <strong>bob</strong> user’s account<br>using tool <a target="_blank" rel="noopener" href="https://github.com/rebootuser/LinEnum">linenum</a>(LinEnum is a script that search for possible paths to escalate privileges on Linux&#x2F;Unix*&#x2F;MacOS hosts)</p>
<p>so i donloaded <strong>linenum</strong> and copied to target machine using <strong>SCP</strong> utility you can also use python server </p>
<p><img src="/imgs/post2/scp-linenum.png" alt="scp-linenum"></p>
<blockquote>
<p>Note: we don’t know either the password of bob or have write permission in bob home directory so we have to copy in &#x2F;tmp directory.</p>
</blockquote>
<p>change the script permision -&gt; <strong>chmod +x linenum</strong> and execute it </p>
<p><img src="/imgs/post2/linenum-res.png" alt="linenum-res"></p>
<p>okay now we have our linenum running lets go through all output and look for some juicy info<br>hmm.. its lot but going all over output i came with most luring info <strong>Crontab Contents</strong> which we already now about and <strong>SUID files</strong>  </p>
<p><strong>SUID</strong>: It is special file permission for executable files. This enables other users to run the file with the effective permissions of the file owner. But Instead of normal x which represents executable permissions. We will see s(this indicates SUID) special permission for the user.<br>i’ll highy recommend you to go throuugh this <a target="_blank" rel="noopener" href="https://www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/">blog</a> </p>
<p><img src="/imgs/post2/suid-bin.png" alt="suid-bin"></p>
<p>where i got two strange file i.e. <strong>root-me</strong> and <strong>final</strong> , surprisingly final was in bob home location inside <strong>.something</strong> dir </p>
<blockquote>
<p>I am assuming that you know about SUID permission and how to abuse SUID bit set binary if not then go through this <a target="_blank" rel="noopener" href="https://www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/">blog</a> </p>
</blockquote>
<h3 id="Gaining-root-privilege-01"><a href="#Gaining-root-privilege-01" class="headerlink" title="Gaining root privilege - 01"></a>Gaining root privilege - 01</h3><p>running <strong>root-me</strong> binary </p>
<p><img src="/imgs/post2/root-me-res.png" alt="root-me-res"></p>
<p>it seems like binary is making request to <a target="_blank" rel="noopener" href="https://pastebin.com/dl/JicYuAuW">https://pastebin.com/dl/JicYuAuW</a> and being saved as <strong>JicYuAuW</strong><br>browsing this URL </p>
<p><img src="/imgs/post2/wget-url.png" alt="wget-res"></p>
<p>nothing just a dummy Loream Ipsum. , but how this reqest being made ?<br>most probably using <strong>wget</strong> utility and called by <strong>system</strong> function(at this time i was just assuming) to make sure i transfered this binary to my machine and decompiled it using ghidra </p>
<p><img src="/imgs/post2/wget-decomp.png" alt="wget-decomp"></p>
<p>and i was right . <strong>system</strong> function is used for make request via wget and if we go back and read the README.txt file again <strong>system</strong> function is vulnerable function </p>
<p>Because system invokes <em>&#x2F;bin&#x2F;sh</em> -c to execute commands, it uses whatever environment variables are configured for the user who executes the program, the most notable of these is the <em>PATH</em> environment variable.</p>
<p>If the programmer forgets to specify the full path for a binary, &#x2F;bin&#x2F;sh will check each of the locations on the <em>PATH</em> in order until it finds an executable with the correct name, as soon as it finds one it executes it with the permissions of the owner of the calling program. </p>
<p>so you can see how this could be used for privilege escalation , didn’t get how? lemme </p>
<p>as here full path of <strong>wget</strong> utility is not specified what we can do is change <strong>PATH</strong> environmeent var to our current directory and create a our own one(wget) where we can write reverse shell or copy the <strong>&#x2F;bin&#x2F;sh</strong> binary as <strong>Evil</strong> via <strong>system</strong> function and ‘cause binary has SUID bit set we’ll prefix sudo to make our Evil binary(bad) run </p>
<p><img src="/imgs/post2/Evil-code.png" alt="Evil-code"></p>
<p><img src="/imgs/post2/Evil-code2.png" alt="Evil-code2"></p>
<p><img src="/imgs/post2/Evil-code3.png" alt="Evil-code3"></p>
<blockquote>
<p>Note :  while writing this writeup i realized that we require to have bob password to run the Evil(bad) file , i thought to leave password as a simple text file in bob’s home direcotry but as it is a CTF machine there would be no fun having sweet without any hustle so i created a simple OSINT challenge for bob pass.</p>
</blockquote>
<h3 id="Bob-password"><a href="#Bob-password" class="headerlink" title="Bob password"></a>Bob password</h3><p><img src="/imgs/post2/osint/osint1.png" alt="osint1"></p>
<p>navigating to <strong>p455w0rd</strong> directory , there is image file named <strong>osint.jpg</strong> </p>
<p><img src="/imgs/post2/osint/osint2.png" alt="osint2"></p>
<p>we have to download it first, you can use <strong>scp</strong>, <strong>python server</strong> or you can just copy the file to <strong>&#x2F;var&#x2F;ftp</strong> and download it from <strong>FTP</strong> server using <strong>get</strong> command </p>
<p><img src="/imgs/post2/osint/osint3.png" alt="osint3"></p>
<p>now we have image file lets go for low hanging fruites first like we did earlier after running exiftool over image file came up with </p>
<p><img src="/imgs/post2/osint/osint4.png" alt="osint4.png"></p>
<p>in comment section there is a line of information i.e. -  <strong>Do you know ‘Avram Veda’ and bob is best friend and he know every secret of bob, to know bob’s secret you should know Avram well</strong><br>you can also run <strong>strings</strong> command e.g. </p>
<p><img src="/imgs/post2/osint/osint5.png" alt="osint5.png"><br>solving<br>so here this hint or i didn’t know at that point says that <strong>Avram Veda</strong> and <strong>bob</strong> is best friend and Avaram know some secret of bob, so we know bob already right?  bob is a user we are currently logged in as and we here <strong>secret</strong> is most probably password of bob user as we need bob pass to make our privesc work<br>and we didn’t come across Avram Veda name throughout solving the machine and also we been told that we should know Avram first to know bob’s secret </p>
<p>hmmm maybe its osint challenge obviously as name of image file isss osing.jpg<br>okay so now we only have this person name to start with.</p>
<p>searching this name on google directly is no use ‘cause you know how google crawler work it will index all relevent things whit this name and we will be keep searching and clicking irrelevent things </p>
<p>so for searching any person we can use social media side like - Twitter, instragram , facebook and so on<br>for that we also have automated by using these tool we can search in all social media site at once </p>
<p>but here i tried manually first in Twitter and ther i got a user with same name </p>
<p><img src="/imgs/post2/osint/osint6.png" alt="osint6.png"></p>
<p>also bio  <strong>p2w</strong> look familiar i.e. Pwn2Own(this CTF name)<br>okay so let see what we get here </p>
<p><img src="/imgs/post2/osint/osint7.png" alt="osint7.png"></p>
<p>as you can see this guy have some Tweets &amp; replies too, i copied first tweet that is in base64 form and decoded it </p>
<p><img src="/imgs/post2/osint/osint8.png" alt="osint8"></p>
<p>okay nothing here, lets see second tweet<br>i had no idea for this cipher string so i aplied all cipher that i came across before </p>
<p><img src="/imgs/post2/osint/osint9.png" alt="osint9"></p>
<p>and it was <strong>ROT47</strong> and we have our output as github link so lets navigate to this link</p>
<p><img src="/imgs/post2/osint/osint10.png" alt="osint10"></p>
<p>this account has only one repositores named i.e. <strong>ohsint</strong> lets go this repositories </p>
<p><img src="/imgs/post2/osint/osint11.png" alt="osint11"></p>
<p>only one file here which is README.md that contain lines of dummy Lorem ipsum looking each line closely nothing got meainingful.<br>if you know about the github commit feature we can see the commit history of repository and made changes so as you can see the right side of the file name 4 commits made </p>
<p><img src="/imgs/post2/osint/osint12.png" alt="osint12"></p>
<p>looking into last commit</p>
<p><img src="/imgs/post2/osint/osint13.png" alt="osint13"></p>
<p>changes on line number 5 it looks flag with link lets go to this URL </p>
<p><img src="/imgs/post2/osint/osint14.png" alt="osint14"></p>
<p>okay so its pastebin file with Title <strong>find me</strong> and with paste <strong>35.487628827907535, 138.7815797959812</strong> it looks like latitude and longitude(latitude and longitude, coordinate system by means of which the position or location of any place on Earth’s surface can be determined and described.) we can search this  coordinates on Google Map like </p>
<p><img src="/imgs/post2/osint/osint15.png" alt="osint14"></p>
<p>so its shop in japan, wow Avram is in Japan.<br>we are not able to see shop name though but by clicking just near to destination mark we can see shop name its <strong>Ichiraku Ramen</strong> </p>
<p><img src="/imgs/post2/osint/osint15.2.png" alt="osint15.2."></p>
<p>i tried this name as a password(both word separately) but it wasnt so i continued my research and finally got the flag. how? lemme show </p>
<p><img src="/imgs/post2/osint/osint16.gif" alt="osint16"></p>
<p>so its bob’s password.</p>
<h3 id="Gaining-root-privilege-02"><a href="#Gaining-root-privilege-02" class="headerlink" title="Gaining root privilege - 02"></a>Gaining root privilege - 02</h3><p>running <strong>final</strong> binary </p>
<p><img src="/imgs/post2/final-res.png" alt="final-res"></p>
<p>woah! , hacker man apeared :D<br>entering random value and getting output <strong>8</strong> one thing to note here that on each random value output is same , and if we enter any long input(A’s here) then it throw segmentation fault err and <strong>Value of Number Is</strong> changes to 41414141 which is hex version of <strong>A</strong> char </p>
<p><img src="/imgs/post2/final-res2.png" alt="final-res2"></p>
<p>so we can cleary see that we are able to write on stack here, which is to say binary is vulnerable to <em><strong>Buffer overflow</strong></em>(occurs when there is more data in a buffer than it can handle, causing data to overflow into adjacent storage), according to README.txt any vulnerable function is being used in binary that is not checking boundary of variable data , lets decomplie the binary with <strong>Ghidra</strong> and see whats wrong .</p>
<p>Looking for Functions in binary i come with this interesting function <strong>win()</strong> -</p>
<p><img src="/imgs/post2/final-win.png" alt="final-win"></p>
<p>that is basically executing <strong>&#x2F;bin&#x2F;sh</strong> shell as root user </p>
<p>main() function -</p>
<p><img src="/imgs/post2/final-mainfunc.png" alt="final-ghidra"></p>
<p>declared 2 variables i.e. <strong>local_38</strong> and <strong>local_c</strong> , assigned number 8 to local_c and user is asked to Enter name and value is stored in local_38 var(line 11) lastly strign - Value of Number is printed with value 8 </p>
<p>okay so whats wrong here? , <em><strong>gets()</strong></em>* function </p>
<p>The gets() function <strong>does not perform bounds checking</strong>, therefore this function is extremely vulnerable to buffer-overflow attacks. It cannot be used safely (unless the program runs in an environment which restricts what can appear on stdin ).</p>
<p>**Lets understand this vulnerability at core level and how can we leverage </p>
<blockquote>
<p>If you already know what Bufer Overflow is and how it work you can skip this part, jump <a href="">here</a></p>
</blockquote>
<h4 id="Program-Execution"><a href="#Program-Execution" class="headerlink" title="Program Execution"></a>Program Execution</h4><p>When we compile the code it get converted to executable format and stored into secondary storage running that executable it loaded in to <strong>RAM</strong> by OS which is to say that, that program is now no longer program it is process and we need space to store that process’s code and data to memory we use this memory architecture to store the program’s data and storage </p>
<p><img src="/imgs/post2/memory-layout.jpg" alt="memory-layout"></p>
<p>code stored in <strong>text</strong> section, initialized data(variables that contain data) stored in initialized data section and uninitialized data into uninitialied data(bss) section these data are static and public variables value then we have <strong>stack</strong> and <strong>heap</strong> section it depends on user if he want to store data with his own desirable size manually at run time then heap section is going to use as it is used for dynamically data allocation otherwise <strong>stack</strong> section.</p>
<p>In our program variables are already assigned storage size while declaration our data is going to store on stack storage </p>
<h4 id="how-stack-work"><a href="#how-stack-work" class="headerlink" title="how stack work?"></a>how stack work?</h4><p>Stacks in Data Structures is a linear type of data structure that follows the LIFO (Last-In-First-Out) principle and allows insertion and deletion operations from one end of the stack data structure, that is top. The call stack is made up of a series of stack frames, each of which corresponds to a function call that is currently being executed or has recently been executed.</p>
<p><img src="/imgs/post2/stack-layout.gif" alt="stack-layout"></p>
<p>The stack is used to store a variety of information, including:</p>
<ul>
<li><p>Local variables: These are variables that are defined and used within a particular function or block of code. When the function is called, space is allocated on the stack for the local variables.</p>
</li>
<li><p>Function arguments: When a function is called, the values of the arguments are passed to the function and stored on the stack.</p>
</li>
<li><p>Return address: When a function is called, the address in memory where the program should resume execution after the function returns is stored on the stack.</p>
</li>
<li><p>Activation records</p>
</li>
</ul>
<h4 id="Activation-records-x2F-Stack-frame"><a href="#Activation-records-x2F-Stack-frame" class="headerlink" title="Activation records&#x2F;Stack frame"></a>Activation records&#x2F;Stack frame</h4><p>An activation record, also known as a stack frame, is a data structure that is used to store information about a particular function call. It includes the function’s local variables, arguments, and return address, as well as other information such as the previous stack frame and any saved registers. Activation records are created and destroyed as functions are called and return, respectively.</p>
<p><img src="/imgs/post2/stack-frame.jpg" alt="stack-frame"></p>
<h4 id="Registers"><a href="#Registers" class="headerlink" title="Registers"></a>Registers</h4><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Processor_register">Registers</a> are small, high-speed storage locations within the CPU (central processing unit) of a computer. They are used to hold data and instructions that the CPU is currently working on or needs quick access to. There are several types of registers that are used for different purposes in a CPU. Most importand register to now for this challenge is SP,FP,IP</p>
<p>SP(Stack Pointer) - This is a register that holds the address of the top of the stack in memory.</p>
<p>FP(Frame Pointer) - The frame pointer register (also known as the base pointer or BP register) is a register in the CPU that is used to hold the address of the current stack frame in a call stack.</p>
<p>IP(Instruction Pointer) - The instruction pointer register (also known as the program counter or PC register) is a register in the CPU that holds the address of the next instruction to be executed by the CPU.</p>
<h4 id="Calling-convention"><a href="#Calling-convention" class="headerlink" title="Calling convention"></a>Calling convention</h4><p>A calling convention is a set of rules that specifies how function arguments are passed to a function and how the function return value is returned to the caller. It also specifies the order in which the arguments are passed and the location in memory where they are stored. go throuhg this <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/10057443/explain-the-concept-of-a-stack-frame-in-a-nutshell">page</a> </p>
<h5 id="Now-we-know-the-all-base-knowlege-to-understand-buffer-overflow-attack-lets-see-how-buffer-overflow-can-be-performed-and-how-can-we-execute-any-arbitary-code-into-memory-or-transfer-code-flow-to-any-evil-function"><a href="#Now-we-know-the-all-base-knowlege-to-understand-buffer-overflow-attack-lets-see-how-buffer-overflow-can-be-performed-and-how-can-we-execute-any-arbitary-code-into-memory-or-transfer-code-flow-to-any-evil-function" class="headerlink" title="Now we know the all base knowlege to understand buffer overflow attack lets see how buffer overflow can be performed and how can we execute any arbitary code into memory or transfer code flow to any evil function"></a>Now we know the all base knowlege to understand buffer overflow attack lets see how buffer overflow can be performed and how can we execute any arbitary code into memory or transfer code flow to any evil function</h5><p>when main function is called this is how stack frame is created for program <strong>final</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Higher addr 	        +-------------------+ ----------</span><br><span class="line">						| saved temporaries |     ^</span><br><span class="line">						+-------------------+     |</span><br><span class="line">						| function argument |     |</span><br><span class="line">						+-------------------+     | </span><br><span class="line">						| function argument |     |</span><br><span class="line">						+-------------------+   main function</span><br><span class="line">						| Return address    |     |</span><br><span class="line">						+-------------------+     | </span><br><span class="line">			    FP --&gt;	| saved RBP         |     |</span><br><span class="line">						+-------------------+     |</span><br><span class="line">						| local var buff    |     |</span><br><span class="line">						+-------------------+     |</span><br><span class="line">						| local var number  |     v</span><br><span class="line">		        SP --&gt; 	+-------------------+ ----------</span><br><span class="line">						|                   |    </span><br><span class="line">Lower addr				+-------------------+      					</span><br></pre></td></tr></table></figure>

<p>now we know vulnerable function(gets()) function is used to store value to variable <strong>local_38</strong> however, variable local_38 size is fixed(44 byte) ‘cause gets() function do not perform bound checking operation<br>we can somehow exceed that limit by random values or <a target="_blank" rel="noopener" href="https://www.sentinelone.com/blog/malicious-input-how-hackers-use-shellcode/">shellcode</a>(Shellcode is sequence of machine code, or executable instructions, that is injected into a computer’s memory with the intent to take control of a running program)  and overwrite the <strong>Return adress</strong> </p>
<p><img src="/imgs/post2/bof.png" alt="bof"></p>
<blockquote>
<p>Stack grows from higher address to lower address and parameter and local variables are assigned in reverse order i.e lower to higher address </p>
</blockquote>
<p>As return adress contain the address of next instruction to be execute when function return , we can calculate the offset(numbers of byte to overwrite the return address) of return address from local variable buff and replace return address with our shell code adress </p>
<p>But we are not going to use shell code here if you remember about <strong>win()</strong> function <strong>&#x2F;bin&#x2F;sh</strong> shell being called in this function as root user so if we replace return address to this function we will be able to get root shell </p>
<p><em><strong>okay enough talking let’s get our hand dirty by exploiting this vulnerbility</strong></em> </p>
<p>first we need calulate the offset of return adress , we will use <strong>gdb-pwndbg</strong>( GDB is a debugger for C (and C++). It allows you to do things like run the program up to a certain point then stop and print out the values of certain variables at that point, or step through the program one line at a time and print out the values of each variable after executing each line.) Python module here</p>
<p>so let’s open the binary in gdb and disassemble the <strong>main</strong> function </p>
<p><img src="/imgs/post2/final-gdb1.png" alt="final-gdb1"></p>
<p><img src="/imgs/post2/final-gdb2.png" alt="final-gdb2"></p>
<p>setting breakpoint(A breakpoint <strong>makes your program stop whenever a certain point in the program is reached</strong>.) using <code>break * &lt;addr&gt;</code> just after gets() function which is basically going to be return address in gets() stack frame so that when we run program with values we  can examine resisters </p>
<p>and then generating a set of special pattern using python pwntool module <strong>cyclic</strong> so that we can calculate exact offset of return address(we’ll just in time)</p>
<p><img src="/imgs/post2/final-gdb3.png" alt="final-gdb3"></p>
<blockquote>
<p>generating 100 cyclic values as we are not sure how many byte it will take to crash the program or write the return address</p>
</blockquote>
<p>then running the program with <em><strong>r</strong></em>(run) command where name field is our cyclic values</p>
<p><img src="/imgs/post2/final-gdb4.png" alt="final-gdb4"></p>
<p>after running the program our <strong>break point</strong> hit ,values get stored in variable precisely on stack</p>
<p><img src="/imgs/post2/final-gdb5.png" alt="final-gdb5"></p>
<p>examining the stack , with command <em><strong>x&#x2F;50x $rsp</strong></em> where x define we have to examine memory with 50 word block in hex form from stack </p>
<p><img src="/imgs/post2/final-gdb5.1.png" alt="final-gdb5.1"></p>
<p>now lets continue and check <strong>registers</strong> if we able to overwrite the return adress in <em><strong>rip</strong></em> register if we succeed program goinna break and throw segmentaion fault </p>
<p><img src="/imgs/post2/final-gdb6.png" alt="final-gdb6"></p>
<p>okay we got segmentation fault error ‘cause we overwritten the return adress and now program don’t know where to jump with that random value </p>
<p>now if you see <strong>ret</strong> instruction value and top of the stack you will get the pattern by which the return adress is overwriten now we just have to find out offset with those first 4 chars by using <em><strong>cyclic  -l</strong></em> </p>
<p><img src="/imgs/post2/final-gdb7.png" alt="gdb-final7"></p>
<p>and we got offset <strong>56</strong> meaning that to overwrite the return adress we need <strong>56 bytes pattern&#x2F;garbage value + adress of win function</strong> , you can get win() function either from gdb itself usging <strong>print win</strong> </p>
<p><img src="/imgs/post2/win-adr.png" alt="win-adr"></p>
<p>or usging <strong>nm</strong> utility </p>
<p><img src="/imgs/post2/win-nm.png" alt="win-nm"></p>
<blockquote>
<p>adress should be in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Endianness">little endian</a> form , A little-endian system stores the least-significant byte at the smallest address let say our win addr is 0x0000000000400727 then it is goint to store in reverse order <code>\x27\x07\x40\x00\x00\x00\x00\x00</code></p>
</blockquote>
<p>okay we have every thing set now our payload should work</p>
<p><em><strong>Payload</strong></em>  <strong>-&gt; (echo -e ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<code>\x27\x07\x40\x00\x00\x00\x00\x00</code>‘) | .&#x2F;final</strong> </p>
<p>switch <strong>-e</strong> enable interpretation of backslash escapes as we are using addr in hex form it should escape or else our payload won’t work</p>
<p><img src="/imgs/post2/exp1.png" alt="exp1"></p>
<p>we did able to call win() function as you can see <em><strong>[+] PWNED!!!</strong></em> msg over there<br>buttt why we didn’t get shell ?  lemme </p>
<p>the problem is when we echo our payload to program because pipe(|) is used here it work as input for program and then close the binary what we need here is that we don’t want the binary to close we need a intermediatary between our payload and binary so that when somthing goes as input by intermediatary output should pops out thus our payload will work and program never close and for that purpose we will use <em><strong>cat</strong></em> utility </p>
<p><em><strong>Payload</strong></em>  <strong>-&gt; (echo -e ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<code>\x27\x07\x40\x00\x00\x00\x00\x00</code>‘; cat) | .&#x2F;final</strong> </p>
<p><img src="/imgs/post2/exp2.png" alt="exp2"></p>
<p>Finallyyy ….</p>
<p><img src="/imgs/post2/iamroot.gif" alt="iamroot"></p>
<p>I AM ROOT! </p>
<p><img src="/imgs/post2/root-flag.png" alt="root-flag"></p>
<p><img src="/imgs/post2/wink2.gif" alt="wink"></p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Participating in a CTF machine challenge is a valuable learning experience for students. Not only does it provide hands-on experience in cybersecurity and penetration testing, but it also helps to develop critical thinking and problem-solving skills. I hope this write-up has inspired you to continue learning about the field of cybersecurity and to participate in more CTF challenges in the future. Remember, the only limit to your knowledge is your own willingness to learn and improve. Keep up the great work and never stop learning! </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archive">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Reconnaissance-Scanning"><span class="toc-number">1.</span> <span class="toc-text">Reconnaissance, Scanning</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gaining-Access"><span class="toc-number">2.</span> <span class="toc-text">Gaining Access</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">2.1.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Manually"><span class="toc-number">2.1.1.</span> <span class="toc-text">Manually</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaining-root-privilege-01"><span class="toc-number">2.1.2.</span> <span class="toc-text">Gaining root privilege - 01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bob-password"><span class="toc-number">2.1.3.</span> <span class="toc-text">Bob password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaining-root-privilege-02"><span class="toc-number">2.1.4.</span> <span class="toc-text">Gaining root privilege - 02</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Program-Execution"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">Program Execution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how-stack-work"><span class="toc-number">2.1.4.2.</span> <span class="toc-text">how stack work?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Activation-records-x2F-Stack-frame"><span class="toc-number">2.1.4.3.</span> <span class="toc-text">Activation records&#x2F;Stack frame</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Registers"><span class="toc-number">2.1.4.4.</span> <span class="toc-text">Registers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Calling-convention"><span class="toc-number">2.1.4.5.</span> <span class="toc-text">Calling convention</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Now-we-know-the-all-base-knowlege-to-understand-buffer-overflow-attack-lets-see-how-buffer-overflow-can-be-performed-and-how-can-we-execute-any-arbitary-code-into-memory-or-transfer-code-flow-to-any-evil-function"><span class="toc-number">2.1.4.5.1.</span> <span class="toc-text">Now we know the all base knowlege to understand buffer overflow attack lets see how buffer overflow can be performed and how can we execute any arbitary code into memory or transfer code flow to any evil function</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">3.</span> <span class="toc-text">Conclusion</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://sf4ult.github.io/2023/02/12/post2/pwn2own/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&text=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&is_video=false&description=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Boot2Root CTF WriteUp : Pwn2Own&body=Check out this article: https://sf4ult.github.io/2023/02/12/post2/pwn2own/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&title=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&name=Boot2Root CTF WriteUp : Pwn2Own&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://sf4ult.github.io/2023/02/12/post2/pwn2own/&t=Boot2Root CTF WriteUp : Pwn2Own"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023
    Durgesh
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archive">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Durge5h/Projects">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
